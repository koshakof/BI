{
  "hash": "1f91f487844fcb9913833d947f5df7c4",
  "result": {
    "markdown": "---\nlang: ru\n\ntitle: 'Применяем ГОСТ стандарт РФ «Контрольные карты Шухарта» для оптимизация рекламных кампаний и других источников трафика'\n\ndescription-meta: 'Оптимизация рекламных кампаний, SEO трафика и любых других источников с помощью метода шести сигм (контрольных карт Шухарта)'\n\ndate: today\ndate-format:  D dddd MMM YYYY\n\nformat:\n  html:\n    toc: true\n    toc-location: left\n    cap-location: top\neditor_options: \n  chunk_output_type: console\nexecute:\n  warning: false\n  message: false\n  error: false\n  echo: false\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n## Вводная. Трагическая. На что мы смотрим в Метрике\n\nЗапустив рекламные кампании неизбежно наступает момент, когда нужно идти в системы аналитики и искать истину.\n\nСоздав отчет система аналитики предлагает нам какой-то такой график.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n\nПрекрасный график показывает нам нежно розовые столбики в динамике. Но, очень быстро, на ум приходит вопрос: «И что?». А и вправду? Что нам делать с этой информацией. Эта динамика хороша или плоха. Мне стоит переживать что столбик от 15.02. выше чем от 14.02 или может даже от 10.01!? Какие решения я должен принять изучив этот график? Даже если я добавлю различные срезы по типу устройства, регионам, таргетам ситуация не станет яснее.\n\nТогда, может таблица в помощь.\n\n\n::: {.cell}\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-5494b816347341406a14\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5494b816347341406a14\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Buttons\",\"ColReorder\",\"FixedHeader\"],\"caption\":\"<caption style=\\\"caption-side: top; text-align: left; color: gray;\\\">\\n  <h4>Таблица: Данные по аккунту Директ<\\/h4>\\n<\\/caption>\",\"data\":[[\"2024-01-09\",\"2024-01-10\",\"2024-01-11\",\"2024-01-12\",\"2024-01-13\",\"2024-01-14\",\"2024-01-15\",\"2024-01-16\",\"2024-01-17\",\"2024-01-18\"],[1320,3490,3273,2242,376,169,3517,3498,2908,528],[10689,9714,6185,3507,1456,1079,4234,5132,3651,4113],[69,154,114,91,32,18,141,181,170,43],[75,148,108,82,31,15,144,184,170,45],[24,40,17,12,4,3,22,37,29,9],[0,3,1,1,1,0,3,3,4,0],[0,1163,3273,2242,376,0,1172,1166,727,0],[19,23,29,25,12,9,25,19,17,12],[0.6,1.6,1.8,2.6,2.2,1.7,3.3,3.5,4.7,1],[0,1.9,0.9,1.1,3.1,0,2.1,1.7,2.4,0],[1.1,1,0.9,0.9,1,0.8,1,1,1,1],[32,27,15.7,14.6,12.9,20,15.3,20.1,17.1,20]],\"container\":\"<table class=\\\"display compact nowrap\\\">\\n  <thead>\\n    <tr>\\n      <th>Date<\\/th>\\n      <th>Cost<\\/th>\\n      <th>Impressions<\\/th>\\n      <th>Clicks<\\/th>\\n      <th>Sessions<\\/th>\\n      <th>Bounces<\\/th>\\n      <th>Goals<\\/th>\\n      <th>CPA<\\/th>\\n      <th>CPC<\\/th>\\n      <th>CTR<\\/th>\\n      <th>CR<\\/th>\\n      <th>SR<\\/th>\\n      <th>BR<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"pageLength\":10,\"dom\":\"t\",\"colReorder\":true,\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,3,4,5,6,7,8,9,10,11,12]},{\"name\":\"Date\",\"targets\":0},{\"name\":\"Cost\",\"targets\":1},{\"name\":\"Impressions\",\"targets\":2},{\"name\":\"Clicks\",\"targets\":3},{\"name\":\"Sessions\",\"targets\":4},{\"name\":\"Bounces\",\"targets\":5},{\"name\":\"Goals\",\"targets\":6},{\"name\":\"CPA\",\"targets\":7},{\"name\":\"CPC\",\"targets\":8},{\"name\":\"CTR\",\"targets\":9},{\"name\":\"CR\",\"targets\":10},{\"name\":\"SR\",\"targets\":11},{\"name\":\"BR\",\"targets\":12}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[1]; $(this.api().cell(row, 1).node()).css({'background':isNaN(parseFloat(value)) || value <= 28.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(10168.000000 - value, 0)/10140.000000 * 100 + '%, #EEC9E5 ' + Math.max(10168.000000 - value, 0)/10140.000000 * 100 + '%)','background-size':'100% 80%','background-repeat':'no-repeat','background-position':'center'});\\nvar value=data[3]; $(this.api().cell(row, 3).node()).css({'background':isNaN(parseFloat(value)) || value <= 3.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(599.000000 - value, 0)/596.000000 * 100 + '%, #EEC9E5 ' + Math.max(599.000000 - value, 0)/596.000000 * 100 + '%)','background-size':'100% 80%','background-repeat':'no-repeat','background-position':'center'});\\nvar value=data[6]; $(this.api().cell(row, 6).node()).css({'background':isNaN(parseFloat(value)) || value <= 0.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(5.000000 - value, 0)/5.000000 * 100 + '%, #EEC9E5 ' + Math.max(5.000000 - value, 0)/5.000000 * 100 + '%)','background-size':'100% 80%','background-repeat':'no-repeat','background-position':'center'});\\n}\"}},\"evals\":[\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nТаблица содержит данные сгруппированы по аккаунту. Некоторые столбцы содержат сумму, а некоторые средние значения, например CTR. \n\nИ что? Стало яснее? Система по привлечению трафика работает? Даже подсветив ячейки ясности не принесло.\n\nНа основании этих данных многие специалисты, бизнесмены и другие коллеги по опасному бизнесу принимают судьбоносные решения.\n\nЭто напоминает бросок кирпича. После тщательной подготовки я бросаю свой кирпичик. Он весело, по параболе, достигает своего апекса. Радостно. Показатели на высоте. И, неизбежно (про неизбежное будет чуть ниже), устремляется вниз. Становится тревожно. Вспотел. Но может так должно быть. Так устроена физика и, по сути, переживать тут не надо.\n\nЧтобы понять когда нужно принимать решения применим силу контрольных карт Шухарта. \n\n\n\n\n## Кто этот такой ваше «контрольный карта Шухарта»!?\n\nКонтрольные карты Шухарта (метод шести сигм) — статистический метод, который позволяет оптимизировать / усовершенствовать процессы в компании. В основе метода лежит предположение, что любые динамически меняющиеся во времени показатели могут быть разделены на 2 группы: системные и частные.\n\nПредполагается, что если значение показателя трактуется как неудовлетворительное, то необходимо определиться с корректными методами его исправления, принимая во внимание тот факт, что системные проблемы должны корректироваться системными методами, а частные — частными. \n\nКроме того, метод используется для оценки повышения / снижения качества управления, предлагая конкретные индикативные показатели, отражающие нарастающую или снижающуюся вариативность процесса (вариативность в концепции рассматривается как главный «враг» эффективности).\n\nГлавная задача научиться различать состояния, в которых находится система, а затем решать, что и кому надо с ней делать (или не делать). ККШ — это и есть диагностический инструмент для ответа на вопрос: надо или не надо вмешиваться в систему, и если надо, то кому?\n\nКонтрольные карты Шухарта приняты и введены в действие [Постановлением Госстандарта России от 15 апреля 1999 г. N 127](https://docs.cntd.ru/document/1200025672)\n\n\n\n\n## Какие задачи решают ККШ\n\n1. Главная задача — оптимизация источников трафика по интересующим нас данным. После внесенных изменений в рекламную кампанию (РК) вы практически сразу увидите результат.\n2. Контроль подрядчиков. С помощью контрольных карт вы увидите результаты работ и поймёте, были ли вообще выполнены какие-либо работы.\n3. Аудит рекламных систем.\n\n\n\n\n## Сфера применения\n\nКонтрольные карты широко применяются в сферах производства и в меньшей степени в сфере услуг. В нашем случае мы применяем карты для улучшения показателей в рекламных кампаниях. Вообще, ККШ можно применить для улучшения любых показателей в бизнесе, которые накладываются на временной ряд.\n\nВ данном кейсе я покажу, как с помощью кода на R можно построить различные типы ККШ на примере действующей рекламной кампании. Тип рекламной кампании, собственно, как и источник не имеют значения, так как анализировать можно практически любые параметры из любых источников, растянутых на временном интервале.\n\n\n\n\n## Как работать с картами\n\nВозможно четыре состояния, в которых находится любой производственный процесс. \n\n- Идеальное состояние – процесс управляем и 100% продукции соответствует допускам. \n- Пороговое состояние – процесс управляем, но не 100% продукции соответствует допускам. \n- На грани хаоса – процесс неуправляем, хотя вся выпускаемая продукция соответствует допускам.\n- Состояние хаоса – процесс неуправляем, и периодически производится брак. \n\nЭнтропия постоянно воздействует на все процессы, вызывая ухудшение качества, разрушение, износ и разрывы, аварии и отказы. Т.е. если не управлять системами привлечения трафика (seo, контекст, smm) они в любом случаи затухнут, просто потому что так работают законы вселенной.\n\n**Критерии роста системы**\n\nШухарт и Деминг выделили два критерия которые должны указывать на то, что кампания активно растет:\n\n- среднеарифметическая растет или снижается в зависимости от параметра;\n- границы сигмы становятся все более узкими. Сокращая вариативность параметра мы берем управление под контроль.\n\n\n**Критерии ухудшения системы**\n\n- средняя арифметическая снижается или растет, если речь идет о негативном параметре;\n- на протяжении шести и более дней (контрольных интервалов)значения скачут с нарастающей волатильностью;\n- если несколько дней подряд наблюдается выход за пределы контрольных границ;\n- если шесть и более дней наблюдается негативная тенденция в значениях (неважно, сверху или снизу). Т.е. значения находятся над или под средней линией.\n\nПравила для обнаружения «вышедших из-под контроля» или неслучайных условий:\n\n- [Western Electric rules](https://en.wikipedia.org/wiki/Western_Electric_rules)\n- [Nelson rules](https://en.wikipedia.org/wiki/Nelson_rules)\n\n\n\n\n## Примеры\n\nРассмотрим несколько примеров как выглядят различные типы карт в различных срезах.\n\nНо сначала давайте попробуем сделать какие-то выводы по графикам, которые вы видите в Метрике или в Директе.\n\nДля примера возьмем анализ расходов в разрезе кампаний. Построим столбчатый график с накоплением и график с точками и линиями.\n\nДа, на графике видно, что что-то происходит. Какие-то РК включаются, какие-то выключаются, но стоит ли переживать из-за этого. Что за пик случился 05.02. и что произошло дальше. \n\n\n\n\n\n\n### XmR-карты\n\nКарты индивидуальных значений и размахов ($XmR-карты$) применяются, когда нет возможности сгруппировать данные.  Данный тип карт менее точен, чем карты средних значений, однако они полезны при старте рекламных кампаний.\n\nКак видно из названия карт применяются два их вида:\n\n- карта индивидуальных значений ($X-карта$). Строится карта в декартовой системе координат, где по оси абсцисс расположены даты, а на оси ординат значения исследуемой метрики.\n- карта размахов. Размах — это разность между наибольшим и наименьшим значениями и обозначается символом $mR$. Размах практически не отражает «срединных» значений, поэтому он неэффективен для описания больших массивов данных и используется для описания множеств, число элементов которых не превосходит 15.\n\n\nРассмотрим mR-карту по всему аккаунту за последние 15 дней.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/unnamed-chunk-11-1.png){width=960}\n:::\n:::\n\n\nСразу видим что 17.03. наблюдается перерасход средств по аккаунту. Были внесены какие-то действия, которые привели к выходу за границы системых значений. Действительно, в этот день были выставлены новые значения по недельному расходу.\n\nРассмотрим $X-карту$ индивидуальных значений за весь анализируемый период.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\nНа графике за весь период видим заметны выходы за границы системы в \n\nПересобирем график для большей информативности.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\nРазумеется мы можем выбрать интересующую нас группу и проверить интересующую нас метрику. Например, на графике ниже видны данные по расходам в разрезе трех объявлений выбранной мною группы.\n\nДопустим меня интересует объявление, которое отображено зеленой линией на графике. Проверим границы по бюджетам, кликам.\n\n",
    "supporting": [
      "shewhart_control_card_ydirect_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\r\n<link href=\"../site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/datatables-binding-0.31/datatables.js\"></script>\r\n<script src=\"../site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\r\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\r\n<link href=\"../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\r\n<link href=\"../site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js\"></script>\r\n<script src=\"../site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js\"></script>\r\n<script src=\"../site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js\"></script>\r\n<script src=\"../site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js\"></script>\r\n<link href=\"../site_libs/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js\"></script>\r\n<link href=\"../site_libs/dt-ext-fixedheader-1.13.6/css/fixedHeader.dataTables.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/dt-ext-fixedheader-1.13.6/js/dataTables.fixedHeader.min.js\"></script>\r\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}