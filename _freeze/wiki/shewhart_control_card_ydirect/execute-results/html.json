{
  "hash": "d5577cddf815b0015d60478a585a2333",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlang: ru\ntitle: 'Применяем ГОСТ стандарт РФ «Контрольные карты Шухарта» для оптимизация рекламных кампаний и других источников трафика'\ndescription-meta: 'Оптимизация рекламных кампаний, SEO трафика и любых других источников с помощью метода шести сигм (контрольных карт Шухарта)'\nauthor: \"Александр Коршаков\"\ndate: today\ndate-format:  D dddd MMM YYYY\nformat:\n  html:\n    toc: true\n    toc-location: left\n    cap-location: top\n    fig-width: 10\n    fig-height: 7\n    code-fold: true\n    link-external-newwindow: true\n    other-links:\n      - text: \"ГОСТ Р 50779.42-99\"\n        href: \"https://docs.cntd.ru/document/1200025672\"\n      - text: \"Western Electric rules\"\n        href: \"https://en.wikipedia.org/wiki/Western_Electric_rules\"\n      - text: \"Nelson rules\"\n        href: \"https://en.wikipedia.org/wiki/Nelson_rules\"\neditor_options: \n  chunk_output_type: console\nexecute:\n  warning: false\n  message: false\n  error: false\n  cache: true\n---\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Код: библиотеки\"}\n# библиотеки используемые в статье для создания графиков, таблиц и обработки данных.\nlibrary(qcc)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gt)\nlibrary(tsibble)\nlibrary(imputeTS)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n</br>\n\n\n## На что специалист смотрит в «Метрике»?\n\nЗапустив рекламные кампании, неизбежно наступает момент анализа эффективности. И вот специалист создает отчет, как на графиках ниже. И что он видит?\n\n\n::: {.cell .fig-column-page}\n\n```{.r .cell-code  code-summary=\"Код: Столбиковый график\"}\n# подготовка таблицы\nacc_df <- df |>\n  reframe(\n    across(where(is.numeric), sum),\n    .by = c(Date)\n    ) |>\n  mutate(\n    Cost = round(Cost),\n    CPA = if_else(Goals == 0 , 0, round(Cost / Goals)),\n    CPC = if_else(Cost == 0, 0, round(Cost / Clicks)),\n    CTR = if_else(Clicks == 0, 0, round(Clicks / Impressions * 100, 1)),\n    CR = if_else(Goals == 0, 0, round(Goals / Clicks * 100, 1)),\n    SR = if_else(Clicks == 0, 0, round(Sessions / Clicks, 1)),\n    BR = if_else(Bounces == 0, 0, round(Bounces / Sessions * 100, 1))\n    )\n\n# строим график\nacc_plot <- ggplot(\n  acc_df,\n  aes(\n    x = Date , \n    y = Sessions\n      )) +\n  \n    geom_col(fill = '#ff79c6') +\n    \n    scale_x_date(\n    date_breaks = \"2 day\", \n    date_labels = \"%d.%m\"\n    ) +\n   \n    theme_minimal() +\n    \n    labs(\n      title = \"Визиты\",\n      subtitle = \"Источник: Директ\",\n      x = NULL,\n      y = \"Визиты\",\n      fill = NULL\n      ) +\n  \n    theme(\n      plot.title  = element_text(size = 12, color = \"gray40\"),\n      plot.subtitle = element_text(size = 12, color = \"gray50\"),\n      axis.title = element_text(size = 10, color = \"gray50\"),\n      axis.text = element_text(size = 8, color = \"gray50\"),\n      axis.text.x = element_text(angle = 90),\n      panel.grid = element_blank(),\n      legend.position = \"top\",\n      legend.justification = \"left\",\n      legend.box.spacing = unit(0.1, \"cm\"),\n      legend.text = element_text(size = 8, color = \"gray50\"), \n      legend.title = element_text(size = 10, color = \"gray50\"),\n      plot.margin = ggplot2::margin(\n        t = 0.3,\n        r = 0.3, \n        b = 0.3,\n        l = 0.3, \n        \"cm\"\n        )\n      )\n\n# создаем интерактивный график\nplotly::ggplotly(acc_plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-65862f0e3a98f5797a72\" style=\"width:100%;height:454px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-65862f0e3a98f5797a72\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[19731,19732,19733,19734,19735,19736,19737,19738,19739,19740,19741,19742,19743,19744,19745,19746,19747,19748,19749,19750,19751,19752,19753,19754,19755,19756,19757,19758,19759,19760,19761,19762,19763,19764,19765,19766,19767,19768,19769,19770,19771,19772,19773,19774,19775,19776,19777,19778,19779,19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19790,19791,19792,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],\"y\":[75,148,108,82,31,15,144,184,170,45,16,15,17,148,117,109,22,39,18,3,130,115,106,22,19,20,14,279,543,202,294,263,343,356,167,142,134,132,95,63,13,146,243,187,110,200,169,136,181,99,122,113,133,123,104,138,93,95,97,33,29,34,108,114,100,131,109,93,43,154,136,139,123,110,100,67,147,161,140,122],\"text\":[\"Date: 2024-01-09<br />Sessions:  75\",\"Date: 2024-01-10<br />Sessions: 148\",\"Date: 2024-01-11<br />Sessions: 108\",\"Date: 2024-01-12<br />Sessions:  82\",\"Date: 2024-01-13<br />Sessions:  31\",\"Date: 2024-01-14<br />Sessions:  15\",\"Date: 2024-01-15<br />Sessions: 144\",\"Date: 2024-01-16<br />Sessions: 184\",\"Date: 2024-01-17<br />Sessions: 170\",\"Date: 2024-01-18<br />Sessions:  45\",\"Date: 2024-01-19<br />Sessions:  16\",\"Date: 2024-01-20<br />Sessions:  15\",\"Date: 2024-01-21<br />Sessions:  17\",\"Date: 2024-01-22<br />Sessions: 148\",\"Date: 2024-01-23<br />Sessions: 117\",\"Date: 2024-01-24<br />Sessions: 109\",\"Date: 2024-01-25<br />Sessions:  22\",\"Date: 2024-01-26<br />Sessions:  39\",\"Date: 2024-01-27<br />Sessions:  18\",\"Date: 2024-01-28<br />Sessions:   3\",\"Date: 2024-01-29<br />Sessions: 130\",\"Date: 2024-01-30<br />Sessions: 115\",\"Date: 2024-01-31<br />Sessions: 106\",\"Date: 2024-02-01<br />Sessions:  22\",\"Date: 2024-02-02<br />Sessions:  19\",\"Date: 2024-02-03<br />Sessions:  20\",\"Date: 2024-02-04<br />Sessions:  14\",\"Date: 2024-02-05<br />Sessions: 279\",\"Date: 2024-02-06<br />Sessions: 543\",\"Date: 2024-02-07<br />Sessions: 202\",\"Date: 2024-02-08<br />Sessions: 294\",\"Date: 2024-02-09<br />Sessions: 263\",\"Date: 2024-02-10<br />Sessions: 343\",\"Date: 2024-02-11<br />Sessions: 356\",\"Date: 2024-02-12<br />Sessions: 167\",\"Date: 2024-02-13<br />Sessions: 142\",\"Date: 2024-02-14<br />Sessions: 134\",\"Date: 2024-02-15<br />Sessions: 132\",\"Date: 2024-02-16<br />Sessions:  95\",\"Date: 2024-02-17<br />Sessions:  63\",\"Date: 2024-02-18<br />Sessions:  13\",\"Date: 2024-02-19<br />Sessions: 146\",\"Date: 2024-02-20<br />Sessions: 243\",\"Date: 2024-02-21<br />Sessions: 187\",\"Date: 2024-02-22<br />Sessions: 110\",\"Date: 2024-02-23<br />Sessions: 200\",\"Date: 2024-02-24<br />Sessions: 169\",\"Date: 2024-02-25<br />Sessions: 136\",\"Date: 2024-02-26<br />Sessions: 181\",\"Date: 2024-02-27<br />Sessions:  99\",\"Date: 2024-02-28<br />Sessions: 122\",\"Date: 2024-02-29<br />Sessions: 113\",\"Date: 2024-03-01<br />Sessions: 133\",\"Date: 2024-03-02<br />Sessions: 123\",\"Date: 2024-03-03<br />Sessions: 104\",\"Date: 2024-03-04<br />Sessions: 138\",\"Date: 2024-03-05<br />Sessions:  93\",\"Date: 2024-03-06<br />Sessions:  95\",\"Date: 2024-03-07<br />Sessions:  97\",\"Date: 2024-03-08<br />Sessions:  33\",\"Date: 2024-03-09<br />Sessions:  29\",\"Date: 2024-03-10<br />Sessions:  34\",\"Date: 2024-03-11<br />Sessions: 108\",\"Date: 2024-03-12<br />Sessions: 114\",\"Date: 2024-03-13<br />Sessions: 100\",\"Date: 2024-03-14<br />Sessions: 131\",\"Date: 2024-03-15<br />Sessions: 109\",\"Date: 2024-03-16<br />Sessions:  93\",\"Date: 2024-03-17<br />Sessions:  43\",\"Date: 2024-03-18<br />Sessions: 154\",\"Date: 2024-03-19<br />Sessions: 136\",\"Date: 2024-03-20<br />Sessions: 139\",\"Date: 2024-03-21<br />Sessions: 123\",\"Date: 2024-03-22<br />Sessions: 110\",\"Date: 2024-03-23<br />Sessions: 100\",\"Date: 2024-03-24<br />Sessions:  67\",\"Date: 2024-03-25<br />Sessions: 147\",\"Date: 2024-03-26<br />Sessions: 161\",\"Date: 2024-03-27<br />Sessions: 140\",\"Date: 2024-03-28<br />Sessions: 122\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,121,198,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.138199412495609,\"r\":11.338582677165356,\"b\":46.417983555293446,\"l\":44.215295005932475},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Визиты\",\"font\":{\"color\":\"rgba(102,102,102,1)\",\"family\":\"\",\"size\":15.940224159402243},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19726.555,19814.445],\"tickmode\":\"array\",\"ticktext\":[\"06.01\",\"08.01\",\"10.01\",\"12.01\",\"14.01\",\"16.01\",\"18.01\",\"20.01\",\"22.01\",\"24.01\",\"26.01\",\"28.01\",\"30.01\",\"01.02\",\"03.02\",\"05.02\",\"07.02\",\"09.02\",\"11.02\",\"13.02\",\"15.02\",\"17.02\",\"19.02\",\"21.02\",\"23.02\",\"25.02\",\"27.02\",\"29.02\",\"02.03\",\"04.03\",\"06.03\",\"08.03\",\"10.03\",\"12.03\",\"14.03\",\"16.03\",\"18.03\",\"20.03\",\"22.03\",\"24.03\",\"26.03\",\"28.03\",\"30.03\",\"01.04\"],\"tickvals\":[19728,19730,19732,19734,19736,19738,19740,19742,19744,19746,19748,19750,19752,19754,19756,19758,19760,19762,19764,19766,19768,19770,19772,19774,19776,19778,19780,19782,19784,19786,19788,19790,19792,19794,19796,19798,19800,19802,19804,19806,19808,19810,19812,19814],\"categoryorder\":\"array\",\"categoryarray\":[\"06.01\",\"08.01\",\"10.01\",\"12.01\",\"14.01\",\"16.01\",\"18.01\",\"20.01\",\"22.01\",\"24.01\",\"26.01\",\"28.01\",\"30.01\",\"01.02\",\"03.02\",\"05.02\",\"07.02\",\"09.02\",\"11.02\",\"13.02\",\"15.02\",\"17.02\",\"19.02\",\"21.02\",\"23.02\",\"25.02\",\"27.02\",\"29.02\",\"02.03\",\"04.03\",\"06.03\",\"08.03\",\"10.03\",\"12.03\",\"14.03\",\"16.03\",\"18.03\",\"20.03\",\"22.03\",\"24.03\",\"26.03\",\"28.03\",\"30.03\",\"01.04\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-27.150000000000002,570.14999999999998],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"200\",\"400\"],\"tickvals\":[0,200,400],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"200\",\"400\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Визиты\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"6d7074b04d41\":{\"x\":{},\"y\":{},\"type\":\"bar\"}},\"cur_data\":\"6d7074b04d41\",\"visdat\":{\"6d7074b04d41\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n\nИли вот такой график.\n\n\n::: {.cell .column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: Линейный график\"}\n# подготовка таблицы\ncamp <- df |>\n  reframe(\n    across(where(is.numeric), sum),\n    .by = c(Date, CampaignId)\n    ) |> \n  filter(Date >='2024-03-01')\n\n\n# проверяем на пропущенные дни и заполняем NA\ncamp <- camp |> \n  as_tsibble(index = Date, key = CampaignId) |> \n  fill_gaps()\n\n\n# строим график\ncamp_plot <- ggplot(\n    camp, \n    aes(\n      x = Date , \n      y = Clicks, \n      group = CampaignId, \n      color = CampaignId)\n    ) +\n  \n  geom_point() +\n  geom_line() +\n    \n  geom_text(\n    aes(label = round(Clicks)),\n    check_overlap = TRUE,\n    vjust = -1,\n    size = 2.5,\n    color = \"grey50\"\n    ) +\n  \n    scale_x_date(\n    date_breaks = \"1 day\", \n    date_labels = \"%d.%m\"\n    ) +\n    \n   theme_minimal() +\n  \n  labs(\n    title = \"Переходы\",\n    subtitle = \"Источник: Директ\",\n    x = NULL,\n    y = \"Клики\",\n    color = \"ID\"\n    ) +\n  \n  theme(\n    plot.title  = element_text(size = 12, color = \"gray40\"),\n    plot.subtitle = element_text(size = 12, color = \"gray50\"),\n    axis.title = element_text(size = 10, color = \"gray50\"),\n    axis.text = element_text(size = 8, color = \"gray50\"),\n    axis.text.x = element_text(angle = 90),\n    panel.grid.minor = element_blank(),\n    panel.grid.major.y = element_blank(),\n    panel.background = element_rect(fill = \"#f9fbfd\", colour = \"white\"),\n    legend.position = \"top\",\n    legend.justification = \"left\",\n    legend.box.spacing = unit(0.1, \"cm\"),\n    legend.text = element_text(size = 8, color = \"gray50\"), \n    legend.title = element_text(size = 10, color = \"gray50\"),\n    plot.margin = ggplot2::margin(\n      t = 0.3,\n      r = 0.3, \n      b = 0.3,\n      l = 0.3, \n      \"cm\"\n      )\n  )\n\ncamp_plot\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/line clicks plot-1.png){width=960}\n:::\n:::\n\n\n\nПрекрасные графики показывают нам нежно-розовые столбики и цветные линии в динамике. Но очень быстро приходит вопрос: «И что?». А и вправду! Что нам делать с этой информацией?\n\nЭта динамика хороша или плоха? Мне стоит переживать, что столбик от 15.02 выше, чем от 14.02, или, может, даже от 10.01!? Какие решения я должен принять, изучив этот график?\n\nТогда, может, таблица в помощь?\n\n\n::: {.cell .tbl-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: Таблица\"}\nacc_gt_tbl <- acc_df |> \n  slice(1:10) |> \n  gt(rowname_col = \"Date\") |> \n  tab_header(\n    title = \"Метрики по аккаунту\",\n    subtitle = \"Источник данных: Директ\"\n  ) |> \n  data_color(\n    columns = Goals,\n    fn = \\(v) lapply(v, \\(x) if (x < 1) \"darkred\" else if (x > 2) \"darkgreen\" else \"black\"),\n    apply_to = \"text\"\n  ) |> \n  data_color(\n    columns = Cost,\n    fn = \\(v) lapply(v, \\(x) if (x < 1000) \"darkgreen\" else if (x > 1000) \"darkred\" else \"black\"),\n    apply_to = \"text\"\n  ) |>\n  fmt_currency(\n    columns = c(Cost, CPA, CPC),\n    currency = \"RUB\",\n    decimals = 0,\n    placement = \"right\",\n    sep_mark = \" \"\n    )\nacc_gt_tbl\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"fgpoyvzsnx\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fgpoyvzsnx table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fgpoyvzsnx thead, #fgpoyvzsnx tbody, #fgpoyvzsnx tfoot, #fgpoyvzsnx tr, #fgpoyvzsnx td, #fgpoyvzsnx th {\n  border-style: none;\n}\n\n#fgpoyvzsnx p {\n  margin: 0;\n  padding: 0;\n}\n\n#fgpoyvzsnx .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fgpoyvzsnx .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fgpoyvzsnx .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fgpoyvzsnx .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fgpoyvzsnx .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fgpoyvzsnx .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fgpoyvzsnx .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fgpoyvzsnx .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fgpoyvzsnx .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fgpoyvzsnx .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fgpoyvzsnx .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fgpoyvzsnx .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fgpoyvzsnx .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fgpoyvzsnx .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fgpoyvzsnx .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fgpoyvzsnx .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fgpoyvzsnx .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fgpoyvzsnx .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fgpoyvzsnx .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fgpoyvzsnx .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fgpoyvzsnx .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fgpoyvzsnx .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fgpoyvzsnx .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fgpoyvzsnx .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fgpoyvzsnx .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fgpoyvzsnx .gt_left {\n  text-align: left;\n}\n\n#fgpoyvzsnx .gt_center {\n  text-align: center;\n}\n\n#fgpoyvzsnx .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fgpoyvzsnx .gt_font_normal {\n  font-weight: normal;\n}\n\n#fgpoyvzsnx .gt_font_bold {\n  font-weight: bold;\n}\n\n#fgpoyvzsnx .gt_font_italic {\n  font-style: italic;\n}\n\n#fgpoyvzsnx .gt_super {\n  font-size: 65%;\n}\n\n#fgpoyvzsnx .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fgpoyvzsnx .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fgpoyvzsnx .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fgpoyvzsnx .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fgpoyvzsnx .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fgpoyvzsnx .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fgpoyvzsnx .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"13\" class=\"gt_heading gt_title gt_font_normal\" style>Метрики по аккаунту</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"13\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Источник данных: Директ</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Cost\">Cost</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Impressions\">Impressions</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Clicks\">Clicks</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Sessions\">Sessions</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Bounces\">Bounces</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Goals\">Goals</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CPA\">CPA</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CPC\">CPC</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CTR\">CTR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CR\">CR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SR\">SR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"BR\">BR</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-09</th>\n<td headers=\"stub_1_1 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">1 320&#8381;</td>\n<td headers=\"stub_1_1 Impressions\" class=\"gt_row gt_right\">10689</td>\n<td headers=\"stub_1_1 Clicks\" class=\"gt_row gt_right\">69</td>\n<td headers=\"stub_1_1 Sessions\" class=\"gt_row gt_right\">75</td>\n<td headers=\"stub_1_1 Bounces\" class=\"gt_row gt_right\">24</td>\n<td headers=\"stub_1_1 Goals\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">0</td>\n<td headers=\"stub_1_1 CPA\" class=\"gt_row gt_right\">0&#8381;</td>\n<td headers=\"stub_1_1 CPC\" class=\"gt_row gt_right\">19&#8381;</td>\n<td headers=\"stub_1_1 CTR\" class=\"gt_row gt_right\">0.6</td>\n<td headers=\"stub_1_1 CR\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"stub_1_1 SR\" class=\"gt_row gt_right\">1.1</td>\n<td headers=\"stub_1_1 BR\" class=\"gt_row gt_right\">32.0</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-10</th>\n<td headers=\"stub_1_2 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">3 490&#8381;</td>\n<td headers=\"stub_1_2 Impressions\" class=\"gt_row gt_right\">9714</td>\n<td headers=\"stub_1_2 Clicks\" class=\"gt_row gt_right\">154</td>\n<td headers=\"stub_1_2 Sessions\" class=\"gt_row gt_right\">148</td>\n<td headers=\"stub_1_2 Bounces\" class=\"gt_row gt_right\">40</td>\n<td headers=\"stub_1_2 Goals\" class=\"gt_row gt_right\" style=\"color: #006400;\">3</td>\n<td headers=\"stub_1_2 CPA\" class=\"gt_row gt_right\">1 163&#8381;</td>\n<td headers=\"stub_1_2 CPC\" class=\"gt_row gt_right\">23&#8381;</td>\n<td headers=\"stub_1_2 CTR\" class=\"gt_row gt_right\">1.6</td>\n<td headers=\"stub_1_2 CR\" class=\"gt_row gt_right\">1.9</td>\n<td headers=\"stub_1_2 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_2 BR\" class=\"gt_row gt_right\">27.0</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-11</th>\n<td headers=\"stub_1_3 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">3 273&#8381;</td>\n<td headers=\"stub_1_3 Impressions\" class=\"gt_row gt_right\">6185</td>\n<td headers=\"stub_1_3 Clicks\" class=\"gt_row gt_right\">114</td>\n<td headers=\"stub_1_3 Sessions\" class=\"gt_row gt_right\">108</td>\n<td headers=\"stub_1_3 Bounces\" class=\"gt_row gt_right\">17</td>\n<td headers=\"stub_1_3 Goals\" class=\"gt_row gt_right\" style=\"color: #006400;\">3</td>\n<td headers=\"stub_1_3 CPA\" class=\"gt_row gt_right\">1 091&#8381;</td>\n<td headers=\"stub_1_3 CPC\" class=\"gt_row gt_right\">29&#8381;</td>\n<td headers=\"stub_1_3 CTR\" class=\"gt_row gt_right\">1.8</td>\n<td headers=\"stub_1_3 CR\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"stub_1_3 SR\" class=\"gt_row gt_right\">0.9</td>\n<td headers=\"stub_1_3 BR\" class=\"gt_row gt_right\">15.7</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-12</th>\n<td headers=\"stub_1_4 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">2 242&#8381;</td>\n<td headers=\"stub_1_4 Impressions\" class=\"gt_row gt_right\">3507</td>\n<td headers=\"stub_1_4 Clicks\" class=\"gt_row gt_right\">91</td>\n<td headers=\"stub_1_4 Sessions\" class=\"gt_row gt_right\">82</td>\n<td headers=\"stub_1_4 Bounces\" class=\"gt_row gt_right\">12</td>\n<td headers=\"stub_1_4 Goals\" class=\"gt_row gt_right\" style=\"color: #000000;\">1</td>\n<td headers=\"stub_1_4 CPA\" class=\"gt_row gt_right\">2 242&#8381;</td>\n<td headers=\"stub_1_4 CPC\" class=\"gt_row gt_right\">25&#8381;</td>\n<td headers=\"stub_1_4 CTR\" class=\"gt_row gt_right\">2.6</td>\n<td headers=\"stub_1_4 CR\" class=\"gt_row gt_right\">1.1</td>\n<td headers=\"stub_1_4 SR\" class=\"gt_row gt_right\">0.9</td>\n<td headers=\"stub_1_4 BR\" class=\"gt_row gt_right\">14.6</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-13</th>\n<td headers=\"stub_1_5 Cost\" class=\"gt_row gt_right\" style=\"color: #006400;\">376&#8381;</td>\n<td headers=\"stub_1_5 Impressions\" class=\"gt_row gt_right\">1456</td>\n<td headers=\"stub_1_5 Clicks\" class=\"gt_row gt_right\">32</td>\n<td headers=\"stub_1_5 Sessions\" class=\"gt_row gt_right\">31</td>\n<td headers=\"stub_1_5 Bounces\" class=\"gt_row gt_right\">4</td>\n<td headers=\"stub_1_5 Goals\" class=\"gt_row gt_right\" style=\"color: #000000;\">1</td>\n<td headers=\"stub_1_5 CPA\" class=\"gt_row gt_right\">376&#8381;</td>\n<td headers=\"stub_1_5 CPC\" class=\"gt_row gt_right\">12&#8381;</td>\n<td headers=\"stub_1_5 CTR\" class=\"gt_row gt_right\">2.2</td>\n<td headers=\"stub_1_5 CR\" class=\"gt_row gt_right\">3.1</td>\n<td headers=\"stub_1_5 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_5 BR\" class=\"gt_row gt_right\">12.9</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-14</th>\n<td headers=\"stub_1_6 Cost\" class=\"gt_row gt_right\" style=\"color: #006400;\">169&#8381;</td>\n<td headers=\"stub_1_6 Impressions\" class=\"gt_row gt_right\">1079</td>\n<td headers=\"stub_1_6 Clicks\" class=\"gt_row gt_right\">18</td>\n<td headers=\"stub_1_6 Sessions\" class=\"gt_row gt_right\">15</td>\n<td headers=\"stub_1_6 Bounces\" class=\"gt_row gt_right\">3</td>\n<td headers=\"stub_1_6 Goals\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">0</td>\n<td headers=\"stub_1_6 CPA\" class=\"gt_row gt_right\">0&#8381;</td>\n<td headers=\"stub_1_6 CPC\" class=\"gt_row gt_right\">9&#8381;</td>\n<td headers=\"stub_1_6 CTR\" class=\"gt_row gt_right\">1.7</td>\n<td headers=\"stub_1_6 CR\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"stub_1_6 SR\" class=\"gt_row gt_right\">0.8</td>\n<td headers=\"stub_1_6 BR\" class=\"gt_row gt_right\">20.0</td></tr>\n    <tr><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-15</th>\n<td headers=\"stub_1_7 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">3 517&#8381;</td>\n<td headers=\"stub_1_7 Impressions\" class=\"gt_row gt_right\">4234</td>\n<td headers=\"stub_1_7 Clicks\" class=\"gt_row gt_right\">141</td>\n<td headers=\"stub_1_7 Sessions\" class=\"gt_row gt_right\">144</td>\n<td headers=\"stub_1_7 Bounces\" class=\"gt_row gt_right\">22</td>\n<td headers=\"stub_1_7 Goals\" class=\"gt_row gt_right\" style=\"color: #006400;\">3</td>\n<td headers=\"stub_1_7 CPA\" class=\"gt_row gt_right\">1 172&#8381;</td>\n<td headers=\"stub_1_7 CPC\" class=\"gt_row gt_right\">25&#8381;</td>\n<td headers=\"stub_1_7 CTR\" class=\"gt_row gt_right\">3.3</td>\n<td headers=\"stub_1_7 CR\" class=\"gt_row gt_right\">2.1</td>\n<td headers=\"stub_1_7 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_7 BR\" class=\"gt_row gt_right\">15.3</td></tr>\n    <tr><th id=\"stub_1_8\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-16</th>\n<td headers=\"stub_1_8 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">3 498&#8381;</td>\n<td headers=\"stub_1_8 Impressions\" class=\"gt_row gt_right\">5132</td>\n<td headers=\"stub_1_8 Clicks\" class=\"gt_row gt_right\">181</td>\n<td headers=\"stub_1_8 Sessions\" class=\"gt_row gt_right\">184</td>\n<td headers=\"stub_1_8 Bounces\" class=\"gt_row gt_right\">37</td>\n<td headers=\"stub_1_8 Goals\" class=\"gt_row gt_right\" style=\"color: #006400;\">3</td>\n<td headers=\"stub_1_8 CPA\" class=\"gt_row gt_right\">1 166&#8381;</td>\n<td headers=\"stub_1_8 CPC\" class=\"gt_row gt_right\">19&#8381;</td>\n<td headers=\"stub_1_8 CTR\" class=\"gt_row gt_right\">3.5</td>\n<td headers=\"stub_1_8 CR\" class=\"gt_row gt_right\">1.7</td>\n<td headers=\"stub_1_8 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_8 BR\" class=\"gt_row gt_right\">20.1</td></tr>\n    <tr><th id=\"stub_1_9\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-17</th>\n<td headers=\"stub_1_9 Cost\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">2 908&#8381;</td>\n<td headers=\"stub_1_9 Impressions\" class=\"gt_row gt_right\">3651</td>\n<td headers=\"stub_1_9 Clicks\" class=\"gt_row gt_right\">170</td>\n<td headers=\"stub_1_9 Sessions\" class=\"gt_row gt_right\">170</td>\n<td headers=\"stub_1_9 Bounces\" class=\"gt_row gt_right\">29</td>\n<td headers=\"stub_1_9 Goals\" class=\"gt_row gt_right\" style=\"color: #006400;\">4</td>\n<td headers=\"stub_1_9 CPA\" class=\"gt_row gt_right\">727&#8381;</td>\n<td headers=\"stub_1_9 CPC\" class=\"gt_row gt_right\">17&#8381;</td>\n<td headers=\"stub_1_9 CTR\" class=\"gt_row gt_right\">4.7</td>\n<td headers=\"stub_1_9 CR\" class=\"gt_row gt_right\">2.4</td>\n<td headers=\"stub_1_9 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_9 BR\" class=\"gt_row gt_right\">17.1</td></tr>\n    <tr><th id=\"stub_1_10\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-01-18</th>\n<td headers=\"stub_1_10 Cost\" class=\"gt_row gt_right\" style=\"color: #006400;\">528&#8381;</td>\n<td headers=\"stub_1_10 Impressions\" class=\"gt_row gt_right\">4113</td>\n<td headers=\"stub_1_10 Clicks\" class=\"gt_row gt_right\">43</td>\n<td headers=\"stub_1_10 Sessions\" class=\"gt_row gt_right\">45</td>\n<td headers=\"stub_1_10 Bounces\" class=\"gt_row gt_right\">9</td>\n<td headers=\"stub_1_10 Goals\" class=\"gt_row gt_right\" style=\"color: #8B0000;\">0</td>\n<td headers=\"stub_1_10 CPA\" class=\"gt_row gt_right\">0&#8381;</td>\n<td headers=\"stub_1_10 CPC\" class=\"gt_row gt_right\">12&#8381;</td>\n<td headers=\"stub_1_10 CTR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_10 CR\" class=\"gt_row gt_right\">0.0</td>\n<td headers=\"stub_1_10 SR\" class=\"gt_row gt_right\">1.0</td>\n<td headers=\"stub_1_10 BR\" class=\"gt_row gt_right\">20.0</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n</br>\n\nЭффективна наша система по привлечению трафика?\n\nНо у нас же есть KPI! Да, наверняка у нас есть KPI и даже план, сверстанный в красивую презентацию. Но будем честны. При запуске кампаний наши KPI берутся из каких-то примерных показателей в нише. Я бы даже сказал, очень примерных. Это, безусловно, лучше, чем ничего, но, как правило, итоговые KPI отличаются значительно.\n\nЧтобы понять границы истинных KPI, насколько эффективно работают кампании и когда нужно принимать решения, применим силу контрольных карт Шухарта.\n\n> Вопрос к размышлению: а, собственно, зачем вообще знать KPI? Какой в этом смысл?\n\n\n\n\n## Что за  «ККШ»!?\n\nКонтрольные карты Шухарта (метод шести сигм) — статистический метод, который позволяет усовершенствовать процессы в компании. В основе метода лежит предположение, что любые динамически меняющиеся во времени показатели могут быть разделены на 2 группы: системные и частные.\n\nПредполагается, что если значение показателя трактуется как неудовлетворительное, то необходимо определиться с корректными методами его исправления, принимая во внимание тот факт, что системные проблемы должны корректироваться системными методами, а частные — частными. \n\nКроме того, метод используется для оценки повышения / снижения качества управления, предлагая конкретные индикативные показатели, отражающие нарастающую или снижающуюся вариативность процесса (вариативность в концепции рассматривается как главный «враг» эффективности).\n\nГлавная задача — научиться различать состояния, в которых находится система, а затем решать, что и кому надо с ней делать (или не делать). ККШ — это и есть диагностический инструмент для ответа на вопрос: надо или не надо вмешиваться в систему, и если надо, то кому?\n\nКонтрольные карты Шухарта приняты и введены в действие [Постановлением Госстандарта России от 15 апреля 1999 г. N 127](https://docs.cntd.ru/document/1200025672)\n\n\n\n\n## Какие задачи решают ККШ?\n\nКонтрольные карты применяются в сферах производства и услуг. В нашем случае, мы будем использовать карты для улучшения показателей в рекламных кампаниях.\n\nГлобально, ККШ могут быть применены для улучшения любых показателей в бизнесе, которые зависят от временного ряда. Анализируются различные источники трафика с группировкой данных до нужного уровня, например, типа устройства, кампаний, объявлений, таргетинга или с группировкой по конкретной посадочной странице на сайте.\n\nТаким образом, специалист по трафику применяет карты:\n\n- для оптимизации рекламных кампаний. Вносим изменения и отслеживаем результат.\n- Контроль подрядчиков. Появится понимание, ведутся ли работы по оптимизации и насколько эффективен процесс.\n- Аудит рекламных систем.\n- АВ-тесты кампаний, рекламных систем, посадочных страниц, объявлений, таргетов и так далее. При этом не нужно выделять отдельные бюджеты и разделять трафик на два потока. Вносим изменения и отслеживаем результат. Карты будут фиксировать изменения анализируемой метрики.\n\nНиже я покажу примеры трех основных типов контрольных карт. Расскажу условия применения и какие выводы можно сделать на основании полученных данных.\n\n\n\n\n## Как работать с картами\n\nВозможно четыре состояния, в которых находится любой производственный процесс. \n\n- Идеальное состояние – процесс управляем, и 100% продукции соответствует допускам. - Пороговое состояние – процесс управляем, но не 100% продукции соответствует допускам. \n- На грани хаоса – процесс неуправляем, хотя вся выпускаемая продукция соответствует допускам. \n- Состояние хаоса – процесс неуправляем, и периодически производится брак. \n\nЭнтропия постоянно воздействует на все процессы, вызывая ухудшение качества, разрушение, износ и разрывы, аварии и отказы. Т. е. если не управлять системами привлечения трафика, они в любом случае затухнут, просто потому, что так работают законы Вселенной ;)\n\n**Критерии роста системы**\n\nШухарт и Деминг выделили два критерия, которые должны указывать на то, что кампания активно растет: \n\n- среднеарифметическая растет или снижается в зависимости от параметра; \n- границы сигмы становятся все более узкими. Сокращая вариативность параметра, мы берем управление под контроль.\n\n\n**Критерии ухудшения системы**\n\n- средняя арифметическая снижается или растет, если речь идет о негативном параметре;\n- на протяжении шести и более дней (контрольных интервалов) значения скачут с нарастающей волатильностью;\n- если несколько дней подряд наблюдается выход за пределы контрольных границ;\n- если шесть и более дней наблюдается негативная тенденция в значениях (неважно, сверху или снизу). Т. е. значения находятся над или под средней линией.\n\nЕщё правила для обнаружения «вышедших из-под контроля» или неслучайных условий:\n\n- [Western Electric rules](https://en.wikipedia.org/wiki/Western_Electric_rules)\n- [Nelson rules](https://en.wikipedia.org/wiki/Nelson_rules)\n\n</br>\n\n:::{.callout}\nЕсть проект, в котором я буду полезен. Обращайтесь!\n[Контакты](https://ihourglass.ru/contacts.html)\n:::\n\n\n## Типы контрольных карт\n\nРассмотрим три основных типа ККШ и способы их создания.\n\n\n### $XmR$-карты\n\n$XmR$-карты — карты индивидуальных значений и размахов. Данный тип карт применяется, когда нет возможности сгруппировать данные. Эти карты менее точны, чем карты средних значений ($\\bar{X}R$-карты), однако они полезны при старте рекламных кампаний или при планируемых значительных изменениях, которые могут повлиять на границы системы. \n\nКак видно из названия, карт применяются два их типа:\n\n- **карта индивидуальных значений** ($X$-карта). Строится карта в декартовой системе координат, где по оси абсцисс расположены даты, а на оси ординат — значения исследуемой метрики.\n\n- **карта размахов** ($mR$-карта). Размах — это разность между наибольшим и наименьшим значениями. Размах практически не отражает «срединных» значений, поэтому он неэффективен для описания больших массивов данных и используется для описания множеств, число элементов которых не превосходит 15.\n\n\nРассмотрим пример $mR$-карты расходов по всему аккаунту за 15 дней.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: mR-карта\"}\n# подготовка таблицы\nacc_date <- df |> \n  reframe(\n    across(where(is.numeric), sum),\n    .by = Date\n    ) |>\n  mutate(Cost = round(Cost))\n\n\n# набор данных для mR-карты\nmr_cost <- acc_date |>\n  filter(Date >= '2024-03-13') |> \n  mutate(Lead = lead(Cost)) |> \n  select(Cost, Lead) |> \n  filter(!is.na(Lead)) |> \n  as.matrix()\n\n\n# создаем значения для оси абсцисс\ntemp <- acc_date |>\n  filter(Date >= '2024-03-13') |> \n  mutate(lab = clock::date_format(Date, format = \"%d.%m\")) |> \n  select(lab)\n\ndf_lab <- temp[1:(nrow(temp) - 1), ] |> \n  as.matrix()\n\n\n# данные для mR-карты\nmr_cost_plot <- qcc(\n  type = \"R\",\n  data = mr_cost,\n  labels = df_lab,\n  plot = FALSE\n  )\n\n\n# создаём mR-картy \nplot.qcc(\n  mr_cost_plot,\n  axes.las = 2,\n  title = \"mR-карта расходов по аккаунту\",\n  ylab = \"Расходы\"\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/mr-card-1.png){width=960}\n:::\n:::\n\n\n\nНа графике видим, что 17.03 наблюдается перерасход средств по аккаунту. Были внесены какие-то действия, которые привели к выходу за границы системных значений. Действительно, в этот день были выставлены новые недельные расходы. \n\nРассмотрим $X$-карту индивидуальных значений за весь анализируемый период.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: X-карта\"}\n# данные для х-карты\nx_cost <- qcc(\n  type = \"xbar.one\",\n  data = acc_date$Cost[1:27],\n  newdata = acc_date$Cost[28:nrow(acc_date)], \n  labels = acc_date$Date[1:27] |> format(\"%d.%m\"),\n  newlabels = acc_date$Date[28:nrow(acc_date)] |> format(\"%d.%m\"),\n  plot = FALSE\n  )\n\n\n# проверяем нижнюю границу\nx_cost$limits[1] <- if_else(x_cost$limits[1] < 0, 0, x_cost$limits[1])\n\n\n# строим график\nplot(\n  x_cost, \n  axes.las = 2, \n  title = \"Х-карта \\n Период 1: с 09.01. Период 2: с 12.02\",\n  ylab = \"Расход\",\n  restore.par = T\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/xbar.one card-1.png){width=960}\n:::\n:::\n\n\n\nВ первую очередь обратим внимание на границы. Нижний порог контрольной границы ($LCL$) равен $0$, а верхний — $≈4337$. На самом деле, нижний порог имеет значение $-1093$. Но мы не можем потратить минус тысячу рублей, поэтому значение нижней границы приравниваем к нулю. \n\nСтоит отметить, что из-за большего временного периода границы на графике стали шире по сравнению с $mR$-картой, но для обзора данных нас это устраивает. \n\nНа графике красными точками зафиксированы выходы за верхние границы расходов. 05.02 был проведен тестовый запуск на новый регион, что и зафиксировали алгоритмы. Далее с помощью карт анализируются метрики по достижению целей, переходов, расходов, $CTR$, $CR$ и другие в различных срезах. Например, на графике ниже видны данные по расходам в разрезе двух объявлений выбранной группы.\n\n\n::: {.cell .column-page}\n\n```{.r .cell-code  code-summary=\"Код: Столбчатый график\"}\nads_df <- df |>\n  reframe(\n    across(where(is.numeric), sum),\n    .by = c(Date, CampaignId, AdGroupId, AdId)\n    ) |> \n  filter(CampaignId %in% \"107880029\",\n         AdGroupId %in% \"5409189158\")\n\n\n# график: столбчатый график с накоплением\nads_df_plot <- ggplot(\n    ads_df, \n    aes(\n      x = Date , \n      y = Cost, \n      group = AdId, \n      fill = AdId\n      )) +\n  \n  geom_col() +\n  \n    scale_x_date(\n    date_breaks = \"1 day\", \n    date_labels = \"%d.%m\"\n    ) +\n    \n   theme_minimal() +\n  \n  labs(\n    title = \"Расходы\",\n    subtitle = \"Директ\",\n    x = NULL,\n    y = \"Расходы, ₽\",\n    fill = NULL\n    ) +\n  \n  theme(\n    plot.title  = element_text(size = 12, color = \"gray40\"),\n    plot.subtitle = element_text(size = 12, color = \"gray50\"),\n    axis.title = element_text(size = 10, color = \"gray50\"),\n    axis.text = element_text(size = 8, color = \"gray50\"),\n    axis.text.x = element_text(angle = 90),\n    panel.grid = element_blank(),\n    legend.text = element_text(size = 8, color = \"gray50\"),\n    legend.title = element_text(size = 10, color = \"gray50\"),\n    plot.margin = ggplot2::margin(\n      t = 0.2,\n      r = 0.2, \n      b = 0.2,\n      l = 0.2, \n      \"cm\"\n      )\n    ) \n# создаем интерактивный график\nplotly::ggplotly(ads_df_plot,tooltip = c(\"x\",\"y\",\"group\"))\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-6d1786afd87ab85af769\" style=\"width:100%;height:454px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6d1786afd87ab85af769\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],\"base\":[0,208.57999999999998,0,0,0,0,52.310000000000002,92.459999999999994,26.25,12.619999999999999,472.89999999999998,373.94,478.44,186.75999999999999,323.85000000000002,115.44,48.07,149.56999999999999,570.91999999999996,433.59999999999997,94.200000000000003,108.17,74.019999999999996,114.44,187.56,194.94,150.06999999999999,18.460000000000001],\"x\":[19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],\"y\":[148.81,641.88000000000011,212.21000000000001,274.07999999999998,303.58999999999997,0,407.54000000000002,705.80000000000007,438.39999999999998,239.22000000000003,353.82000000000005,402.98999999999995,229.26000000000005,89.350000000000023,83.009999999999991,14.370000000000005,9.9200000000000017,223.96999999999997,88.529999999999973,144.17000000000002,132.18000000000001,98.739999999999995,174.44999999999999,51.5,401.59000000000009,503.72000000000008,210.46999999999997,273.79000000000002],\"text\":[\"Date: 2024-02-27<br />Cost: 148.81<br />AdId: 15883344950\",\"Date: 2024-02-28<br />Cost: 641.88<br />AdId: 15883344950\",\"Date: 2024-02-29<br />Cost: 212.21<br />AdId: 15883344950\",\"Date: 2024-03-01<br />Cost: 274.08<br />AdId: 15883344950\",\"Date: 2024-03-02<br />Cost: 303.59<br />AdId: 15883344950\",\"Date: 2024-03-03<br />Cost:   0.00<br />AdId: 15883344950\",\"Date: 2024-03-04<br />Cost: 407.54<br />AdId: 15883344950\",\"Date: 2024-03-05<br />Cost: 705.80<br />AdId: 15883344950\",\"Date: 2024-03-06<br />Cost: 438.40<br />AdId: 15883344950\",\"Date: 2024-03-07<br />Cost: 239.22<br />AdId: 15883344950\",\"Date: 2024-03-11<br />Cost: 353.82<br />AdId: 15883344950\",\"Date: 2024-03-12<br />Cost: 402.99<br />AdId: 15883344950\",\"Date: 2024-03-13<br />Cost: 229.26<br />AdId: 15883344950\",\"Date: 2024-03-14<br />Cost:  89.35<br />AdId: 15883344950\",\"Date: 2024-03-15<br />Cost:  83.01<br />AdId: 15883344950\",\"Date: 2024-03-16<br />Cost:  14.37<br />AdId: 15883344950\",\"Date: 2024-03-17<br />Cost:   9.92<br />AdId: 15883344950\",\"Date: 2024-03-18<br />Cost: 223.97<br />AdId: 15883344950\",\"Date: 2024-03-19<br />Cost:  88.53<br />AdId: 15883344950\",\"Date: 2024-03-20<br />Cost: 144.17<br />AdId: 15883344950\",\"Date: 2024-03-21<br />Cost: 132.18<br />AdId: 15883344950\",\"Date: 2024-03-22<br />Cost:  98.74<br />AdId: 15883344950\",\"Date: 2024-03-23<br />Cost: 174.45<br />AdId: 15883344950\",\"Date: 2024-03-24<br />Cost:  51.50<br />AdId: 15883344950\",\"Date: 2024-03-25<br />Cost: 401.59<br />AdId: 15883344950\",\"Date: 2024-03-26<br />Cost: 503.72<br />AdId: 15883344950\",\"Date: 2024-03-27<br />Cost: 210.47<br />AdId: 15883344950\",\"Date: 2024-03-28<br />Cost: 273.79<br />AdId: 15883344950\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"15883344950\",\"legendgroup\":\"15883344950\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],\"y\":[0,208.57999999999998,0,0,0,0,52.310000000000002,92.459999999999994,26.25,12.619999999999999,472.89999999999998,373.94,478.44,186.75999999999999,323.85000000000002,115.44,48.07,149.56999999999999,570.91999999999996,433.59999999999997,94.200000000000003,108.17,74.019999999999996,114.44,187.56,194.94,150.06999999999999,18.460000000000001],\"text\":[\"Date: 2024-02-27<br />Cost:   0.00<br />AdId: 15883344951\",\"Date: 2024-02-28<br />Cost: 208.58<br />AdId: 15883344951\",\"Date: 2024-02-29<br />Cost:   0.00<br />AdId: 15883344951\",\"Date: 2024-03-01<br />Cost:   0.00<br />AdId: 15883344951\",\"Date: 2024-03-02<br />Cost:   0.00<br />AdId: 15883344951\",\"Date: 2024-03-03<br />Cost:   0.00<br />AdId: 15883344951\",\"Date: 2024-03-04<br />Cost:  52.31<br />AdId: 15883344951\",\"Date: 2024-03-05<br />Cost:  92.46<br />AdId: 15883344951\",\"Date: 2024-03-06<br />Cost:  26.25<br />AdId: 15883344951\",\"Date: 2024-03-07<br />Cost:  12.62<br />AdId: 15883344951\",\"Date: 2024-03-11<br />Cost: 472.90<br />AdId: 15883344951\",\"Date: 2024-03-12<br />Cost: 373.94<br />AdId: 15883344951\",\"Date: 2024-03-13<br />Cost: 478.44<br />AdId: 15883344951\",\"Date: 2024-03-14<br />Cost: 186.76<br />AdId: 15883344951\",\"Date: 2024-03-15<br />Cost: 323.85<br />AdId: 15883344951\",\"Date: 2024-03-16<br />Cost: 115.44<br />AdId: 15883344951\",\"Date: 2024-03-17<br />Cost:  48.07<br />AdId: 15883344951\",\"Date: 2024-03-18<br />Cost: 149.57<br />AdId: 15883344951\",\"Date: 2024-03-19<br />Cost: 570.92<br />AdId: 15883344951\",\"Date: 2024-03-20<br />Cost: 433.60<br />AdId: 15883344951\",\"Date: 2024-03-21<br />Cost:  94.20<br />AdId: 15883344951\",\"Date: 2024-03-22<br />Cost: 108.17<br />AdId: 15883344951\",\"Date: 2024-03-23<br />Cost:  74.02<br />AdId: 15883344951\",\"Date: 2024-03-24<br />Cost: 114.44<br />AdId: 15883344951\",\"Date: 2024-03-25<br />Cost: 187.56<br />AdId: 15883344951\",\"Date: 2024-03-26<br />Cost: 194.94<br />AdId: 15883344951\",\"Date: 2024-03-27<br />Cost: 150.07<br />AdId: 15883344951\",\"Date: 2024-03-28<br />Cost:  18.46<br />AdId: 15883344951\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"15883344951\",\"legendgroup\":\"15883344951\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":42.738874328131153,\"r\":7.559055118110237,\"b\":41.018658470928997,\"l\":40.435767446877357},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Расходы\",\"font\":{\"color\":\"rgba(102,102,102,1)\",\"family\":\"\",\"size\":15.940224159402243},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[19778.004999999997,19811.995000000003],\"tickmode\":\"array\",\"ticktext\":[\"26.02\",\"27.02\",\"28.02\",\"29.02\",\"01.03\",\"02.03\",\"03.03\",\"04.03\",\"05.03\",\"06.03\",\"07.03\",\"08.03\",\"09.03\",\"10.03\",\"11.03\",\"12.03\",\"13.03\",\"14.03\",\"15.03\",\"16.03\",\"17.03\",\"18.03\",\"19.03\",\"20.03\",\"21.03\",\"22.03\",\"23.03\",\"24.03\",\"25.03\",\"26.03\",\"27.03\",\"28.03\",\"29.03\"],\"tickvals\":[19779,19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19790,19791,19792,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810,19811],\"categoryorder\":\"array\",\"categoryarray\":[\"26.02\",\"27.02\",\"28.02\",\"29.02\",\"01.03\",\"02.03\",\"03.03\",\"04.03\",\"05.03\",\"06.03\",\"07.03\",\"08.03\",\"09.03\",\"10.03\",\"11.03\",\"12.03\",\"13.03\",\"14.03\",\"15.03\",\"16.03\",\"17.03\",\"18.03\",\"19.03\",\"20.03\",\"21.03\",\"22.03\",\"23.03\",\"24.03\",\"25.03\",\"26.03\",\"27.03\",\"28.03\",\"29.03\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-42.523000000000003,892.98300000000006],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"200\",\"400\",\"600\",\"800\"],\"tickvals\":[0,200.00000000000003,400,600,800],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"200\",\"400\",\"600\",\"800\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Расходы, ₽\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"6d70279b3aa8\":{\"x\":{},\"y\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"6d70279b3aa8\",\"visdat\":{\"6d70279b3aa8\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n</br>\n\nРассмотрим $R$-карту размахов по кликам «красного» объявления.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: R-карта\"}\n# набор данных для mR-карты\nmr_df <- ads_df |>\n  filter(AdId %in% '15883344950') |> \n  mutate(Lead = lead(Clicks)) |> \n  select(Clicks, Lead) |> \n  filter(!is.na(Lead)) |> \n  as.matrix()\n\n\n# создаем значения для оси абсцисс\ntemp <- ads_df |>\n  filter(AdId %in% '15883344950') |>\n  mutate(lab = clock::date_format(Date, format = \"%d.%m\")) |> \n  select(lab)\n\nlab_df <- temp[1:(nrow(temp) - 1), ] |> \n  as.matrix()\n\n\n# данные для mR-карты\nmr_plot <- qcc(\n  type = \"R\",\n  data = mr_df,\n  labels = lab_df,\n  plot = FALSE\n  )\n\n\n# создаём mR-картy \nplot.qcc(\n  mr_plot,\n  axes.las = 2,\n  title = \"mR-карта\",\n  ylab = \"Клики\"\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/ad r-card-1.png){width=960}\n:::\n:::\n\n\n\nОбнаружены два выхода за контрольные границы. Фиксируем разницу в кликах между 27 и 28 датами в феврале и между 24 и 25 в марте. Знаем из графика выше, что в эти дни был меньший расход на объявления по сравнению со следующим днём.\n\nСоздадим $X$-карту.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: X-карта\"}\nads_qcc <- ads_df |>\n  filter(AdId %in% '15883344950')\n\n# данные для х-карты\nx_df <- qcc(\n  type = \"xbar.one\",\n  data = ads_qcc$Clicks,\n  labels = ads_qcc$Date |> format(\"%d.%m\"),\n  plot = FALSE\n  )\n\n# устанавливаем предупреждающие границы\nsg1 <- limits.xbar.one(x_df$center, x_df$std.dev, x_df$sizes, 1)\nsg2 <- limits.xbar.one(x_df$center, x_df$std.dev, x_df$sizes, 2)\n\n# корректировка нижней границы LCL\nx_df$limits[1] <- if_else(x_df$limits[1] < 0, 0, x_df$limits[1])\n\n\n\n# строим график\nplot(\n  x_df, \n  axes.las = 2,\n  title = \"Х-карта\",\n  ylab = \"Клики\",\n  restore.par = FALSE\n  )\n\n# добавляем предупреждающие границы\nabline(h = sg1, lty = 3, col = \"gray\")\nabline(h = sg2, lty = 3, col = \"gray\")\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/ad x-card-1.png){width=960}\n:::\n:::\n\n\n\nВидим, что на графике индивидуальных значений нет выхода за границы. Это означает, что система фиксирует на карте размахов дни, когда алгоритмы показа объявлений начинают корректировку показов объявлений, но на общую картину это не влияет, и количество кликов не выходит за границы, т. е. тут видна работа системы, а не работа специалиста.\n\n</br>\n\n\n### $U$-карты\n\nНиже текст из ГОСТ.\n\n*«Данный тип карт используется для анализа альтернативных данных. Альтернативные данные представляют собой наблюдения, фиксирующие наличие или отсутствие некоторых характеристик (или признаков) у каждой единицы рассматриваемой подгруппы. На основе этих данных производится подсчет числа единиц, обладающих или не обладающих данным признаком, или число таких событий в единице продукции, группе или области. ... U-карты основаны на распределении Пуассона.»*\n\n>Кстати, вы знаете, как рассчитать бюджет для рекламной кампании с помощью распределения Пуассона? Об этом, пожалуй, напишу в следующей статье.\n\nДанные карты используются для выявления брака на единицу продукции или на выборку из продукции. В нашем случае в роли выборки выступает метрика показов или кликов сгруппированная по дням, месяцам или иным подгруппам, а кол-во «брака» в нашем случаи это кол-во кликов или достигнутых целей. На картах отображаются отношения кликов к показам (CTR) или целей к кликам (CR) в абсолютных единицах. \n\nАнализировать «ситиар» по всему аккаунту дело не благодарное и исключительно тревожное. Данная метрика сильно зависит от типов рекламных кампаний используемых в аккаунте. \n\nНапример, в аккаунте может быть одна РК на поиске, а вторая в РСЯ, тогда средний «ситиар» нам в целом ни о чем не скажет. Потому что «ситиар» на поиске сильно выше чем в РСЯ.\n\nБолее того, если РК в РСЯ переодически отключается, то мы будем создавать эффект «низкой базы» из-за чего наш график будет «болеть» корью (множество красных точек — сигнал выходы за границы «разумного»).\n\nПример данных по аккаунту.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: U-карта\"}\n# подготовка таблицы\nctr_u <- df |> \n  reframe(\n    across(c(Impressions, Clicks), sum),\n    .by = Date\n    )\n\n# данные для u-карты\nctr_u_plot <- qcc(\n  type = \"u\",\n  data = ctr_u[[3]],\n  sizes = ctr_u[[2]],\n  labels = ctr_u$Date |> format(\"%d.%m\"),\n  plot = FALSE\n  )\n\n\n# строим график\nplot.qcc(\n  ctr_u_plot,\n  axes.las = 2, \n  title = \"U-карта коэф. кликов (CTR) \\n в абсолютных значениях\",\n  ylab = \"CTR\"\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/account u-card-1.png){width=960}\n:::\n:::\n\n\nГрафик «заболел». Анализировать такие данные не имеет смысла. Необходимо разделить данные по типу рекламных кампаний. \n\nРассмотрим $u$-карту CTR на примере поискового трафика.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: U-карта\"}\n# подготовка таблицы\nu_card <- df |> \n  reframe(\n    across(c(Impressions, Clicks), sum),\n    .by = c(Date, AdNetworkType)\n    )\n\n# фильтруем данные\nctr_u <- u_card |> \n  filter(AdNetworkType %in% 'SEARCH',\n         Date>=\"2024-03-01\") |> \n  select(Date, Impressions, Clicks)\n\n# данные для u-карты\nctr_u_plot <- qcc(\n  type = \"u\",\n  data = ctr_u[[3]],\n  sizes = ctr_u[[2]],\n  labels = ctr_u$Date |> format(\"%d.%m\"),\n  plot = FALSE\n  )\n\n\n# строим график\nplot.qcc(\n  ctr_u_plot,\n  axes.las = 2, \n  title = \"U-карта коэф. кликов (CTR) \\n в абсолютных значениях\",\n  ylab = \"CTR\"\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/search u-card-1.png){width=960}\n:::\n:::\n\n\nОсобенность данной карты в том, что у неё плавающие границы. Как именно они рассчитываются, описано в ГОСТе. \n\nКарта хорошо помогает в работе с объявлениями. Вносим изменение в объявление и наблюдаем, как сильно это повлияло на заметность объявления в поиске или в рекламных сетях Яндекса. \n\nТакже данный тип карты можно применять при работе над повышением конверсии на посадочных страницах.\n\n\n\n\n### $\\bar{X}R$-карты\n\nНиже текст из ГОСТ.\n\n>*«Карты запускаются вместе с процессом и дают независимую картину того, на что процесс способен. После этого характеристики процесса можно сравнивать или нет с установленными требованиями.*\n>\n>*Карты для количественных данных отражают состояние процесса через разброс (изменчивость от единицы к единице) и через расположение центра (среднее процесса). Поэтому контрольные карты для количественных данных почти всегда применяют и анализируют парами — одна карта для расположения и одна — для разброса.»*\n\nКлючевое:\n\n- карты дают независимую картину того, на что процесс способен. Т. е. мы точно знаем мощность источника трафика и сможем установить контрольные KPI.\n\n- контрольные карты используются парами. Одна карта — расположение средних значений в декартовой системе координат, и одна для разброса.\n\nПриведу пример анализа целей по всему аккаунту.\n\nСначала рассмотрим данные по достижению целей на столбчатом графике для лучшего понимания происходящего на контрольных картах.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: Столбчатый график\"}\ngoal_df <- df |> \n  filter(AdNetworkType %in% 'SEARCH') |> \n  mutate(Week = clock::date_format(Date, format = \"%W\")) |> \n  reframe(\n    across(c(Goals), sum),\n    .by = c(Week)\n    )\n  \n  \ngoal_plot <- ggplot(\n  goal_df,\n  aes(\n    x = Week , \n    y = Goals\n    )) +\n\n  geom_col(fill = '#ff79c6') +\n  \n  theme_minimal() +\n  labs(\n    title = \"Цели на поиске сгруппированные по неделям\",\n    subtitle = \"Источник: Директ\",\n    x = \"Неделя\",\n    y = \"Кол-во целей\",\n    fill = \"Номер недели\"\n    ) +\n  theme(\n    plot.title  = element_text(size = 12, color = \"gray40\"),\n    plot.subtitle = element_text(size = 12, color = \"gray50\"),\n    axis.title = element_text(size = 10, color = \"gray50\"),\n    axis.text = element_text(size = 8, color = \"gray50\"),\n    axis.text.x = element_text(angle = 90),\n    panel.grid = element_blank(),\n    legend.position = \"top\",\n    legend.justification = \"left\",\n    legend.box.spacing = unit(0.1, \"cm\"),\n    legend.text = element_text(size = 8, color = \"gray50\"),\n    legend.title = element_text(size = 10, color = \"gray50\"),\n    plot.margin = ggplot2::margin(\n      t = 0.3,\n      r = 0.3, \n      b = 0.3,\n      l = 0.3, \n      \"cm\"\n      )\n    )\n\n# создаем интерактивный график\nplotly::ggplotly(goal_plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-685f98afdc28919fafd6\" style=\"width:100%;height:454px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-685f98afdc28919fafd6\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],\"base\":[0,0,0,0,0,0,0,0,0,0,0,0],\"x\":[1,2,3,4,5,6,7,8,9,10,11,12],\"y\":[7,9,2,6,11,15,6,5,5,6,8,11],\"text\":[\"Week: 02<br />Goals:  7\",\"Week: 03<br />Goals:  9\",\"Week: 04<br />Goals:  2\",\"Week: 05<br />Goals:  6\",\"Week: 06<br />Goals: 11\",\"Week: 07<br />Goals: 15\",\"Week: 08<br />Goals:  6\",\"Week: 09<br />Goals:  5\",\"Week: 10<br />Goals:  5\",\"Week: 11<br />Goals:  6\",\"Week: 12<br />Goals:  8\",\"Week: 13<br />Goals: 11\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(255,121,198,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":48.138199412495609,\"r\":11.338582677165356,\"b\":43.761279528726419,\"l\":38.901886952798399},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"title\":{\"text\":\"Цели на поиске сгруппированные по неделям\",\"font\":{\"color\":\"rgba(102,102,102,1)\",\"family\":\"\",\"size\":15.940224159402243},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,12.6],\"tickmode\":\"array\",\"ticktext\":[\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\",\"12\",\"13\"],\"tickvals\":[1,2,3,4.0000000000000009,5,6,7.0000000000000009,8,9,10,11,12],\"categoryorder\":\"array\",\"categoryarray\":[\"02\",\"03\",\"04\",\"05\",\"06\",\"07\",\"08\",\"09\",\"10\",\"11\",\"12\",\"13\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-90,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Неделя\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.75,15.75],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"5\",\"10\",\"15\"],\"tickvals\":[0,5,10,15],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"5\",\"10\",\"15\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.6529680365296811,\"tickwidth\":0,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Кол-во целей\",\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":13.283520132835205}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":null,\"bordercolor\":null,\"borderwidth\":0,\"font\":{\"color\":\"rgba(127,127,127,1)\",\"family\":\"\",\"size\":10.62681610626816}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"6d707691647d\":{\"x\":{},\"y\":{},\"type\":\"bar\"}},\"cur_data\":\"6d707691647d\",\"visdat\":{\"6d707691647d\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n</br>\n\nСоздаем карту *размахов средних значений* по неделям.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: R-карта\"}\n# создадим набор данных и дополним пропущенные дни значением по алгоритму Калмана \nxr_card <- df |> \n  reframe(\n    across(c(Goals), sum),\n    .by = c(Date, AdNetworkType)\n    ) |> \n  filter(AdNetworkType %in% 'SEARCH') |> \n  as_tsibble(\n    index = Date, \n    key = AdNetworkType\n    ) |>\n  fill_gaps(\n    .start = as.Date('2024-01-08'), \n    .end = as.Date('2024-03-31')\n    ) |>\n  imputeTS::na_kalman() |>\n  mutate(\n    Goals = round(Goals),\n    Week = clock::date_format(Date, format = \"%W\")\n    )\n\n# группируем данные для графика\nxr_card_gr <- with(xr_card, qcc.groups(Goals , Week))\n\n# данные для создания графика\nxr_card_plt <- qcc(\n  type = \"R\",\n  data = xr_card_gr[1:4,],\n  newdata = xr_card_gr[4:nrow(xr_card_gr),],\n  plot = FALSE\n  )\n\n# установка предупредждающих границ\nsg1 <- limits.xbar(xr_card_plt$center, xr_card_plt$std.dev, xr_card_plt$sizes, 1)\nsg2 <- limits.xbar(xr_card_plt$center, xr_card_plt$std.dev, xr_card_plt$sizes, 2)\n\n# корректировка нижней границы LCL\nxr_card_plt$limits[1] <- if_else(xr_card_plt$limits[1] < 0, 0, xr_card_plt$limits[1])\n\n\n# строим график\nplot.qcc(\n  xr_card_plt,\n  title = \"Процесс находится под стат контролем \\n Выходы за границы не обнаружены\",\n  ylab = \"Цель\",\n  xlab = \"Неделя\",\n  restore.par = FALSE\n  )\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/avr.r plot-1.png){width=960}\n:::\n:::\n\n\n\nЧто видно на графике? \n\nГОСТ\n\n>*$R$-карта выявляет любую нежелательную вариацию внутри подгрупп и служит индикатором изменчивости исследуемого процесса. Это мера состоятельности и однородности процесса. Если $R$-карта показывает, что вариации внутри подгрупп не изменяются, то это значит, что процесс остается в статистически управляемом состоянии.*\n\nВ данном случае трафик из Директа находится в статистически управляемом процессе. Выходы за границы не обнаружены. Т. е. внутри подгрупп (неделя) вариации по достижению целей остаются под контролем.\n\nСоздаем карту *средних значений*, сгруппированных по неделям.\n\n\n::: {.cell .fig-column-body-outset}\n\n```{.r .cell-code  code-summary=\"Код: X-карта\"}\n# данные для создания графика\nxr_card_plt <- qcc(\n  type = \"xbar\",\n  data = xr_card_gr[1:4,],\n  newdata = xr_card_gr[4:nrow(xr_card_gr),],\n  plot = FALSE\n  )\n\n# установка предупредждающих границ\nsg1 <- limits.xbar(xr_card_plt$center, xr_card_plt$std.dev, xr_card_plt$sizes, 1)\nsg2 <- limits.xbar(xr_card_plt$center, xr_card_plt$std.dev, xr_card_plt$sizes, 2)\n\n# корректировка нижней границы LCL\nxr_card_plt$limits[1] <- if_else(xr_card_plt$limits[1] < 0, 0, xr_card_plt$limits[1])\n\n# строим график\nplot.qcc(\n  xr_card_plt,\n  title = \"Обнаружен выход за границы на 7 неделе работы РК\",\n  xlab = \"Неделя\",\n  ylab = \"Среднее в неделе\",\n  restore.par = FALSE\n  )\n\n# добавляем предупреждающие границы\nabline(h = sg1, lty = 3, col = \"gray\")\nabline(h = sg2, lty = 3, col = \"gray\")\n```\n\n::: {.cell-output-display}\n![](shewhart_control_card_ydirect_files/figure-html/avr.x plot-1.png){width=960}\n:::\n:::\n\n\n\nЧто мы видим на графике? \n\nИз ГОСТа.\n\n>*$X$-карта показывает, где находится среднее процесса и какова его стабильность. Та же карта выявляет нежелательные вариации между подгруппами и вариации относительно их среднего.*\n\nИнтерпретация может быть не совсем очевидной. \n\nВо-первых, на шкале ординат мы видим не суммарные значения по неделям, а среднее значение достигнутых целей внутри недели (по-другому, среднее значение в день). Т. е. мы сложили за неделю все цели и разделили на $7$. Если сгруппировать данные по месяцам, то получим среднее значение в неделю и так далее. По шкале абсцисс — номер недели 2024 года. \n\nВо-вторых, границы нашей системы по привлечению обращений в кампанию составляют от $0$ до $2–3$ обращений в день. При этом стоит отметить, что в данном случае, если более шести дней подряд кол-во конверсий не меняется (нет обращений или по $1–2$ в день), то переживать, срочно бежать и что-то делать не надо. \n\n>На рынке есть множество ниш со сложными продуктами, где может быть маленький спрос или сложный продукт. В таких нишах, если до шести дней не будет обращений в компанию, то это нормальное явление. Нужно понимать границы системы и в какой нише работаете и корректировать ожидания от рекламных активностей. Плюс не забываем о моделях атрибуции в рекламных системах. Например, я часто сталкиваюсь с тем, что конверсии досчитываются в промежутки до 21 дня. \n\nРазберемся, что показывает график. На седьмой неделе работы рекламной кампании зафиксирован выход за границу по среднему значению между группами. Исходя из столбчатого графика выше, в этот день было больше всего конверсий за весь анализируемый период, что привело к повышенному среднему значению среди всех остальных групп. Рассмотрим табличные данные в этот период.\n\n\n::: {.cell .tbl-column-page}\n\n```{.r .cell-code  code-summary=\"Код: Таблица\"}\ngoal_tbl <- df |> \n  filter(AdNetworkType %in% 'SEARCH') |> \n  mutate(Week = clock::date_format(Date, format = \"%W\")) |> \n  reframe(\n    across(c(Goals), sum),\n    .by = c(Date, Week)\n    ) |> \n  filter(Date >=\"2024-02-05\" & Date <= \"2024-02-25\")\n\ngt(goal_tbl, rowname_col = \"Date\") |> \n  tab_header(\n    title = \"Данные по целям\",\n    subtitle = \"Источник данных: Директ\"\n  ) |> \n  data_color(\n    columns = Week,\n    rows = Week == \"07\",\n    method = \"auto\",\n    palette = \"red\",\n    apply_to = \"text\"\n  ) |> \n  tab_row_group(\n    label = \"Шестая неделя\",\n    rows = 1:7\n  ) |>\n  tab_row_group(\n    label = \"Седьмая неделя\",\n    rows = 8:12\n  ) |>\n  tab_row_group(\n    label = \"Восьмая неделя\",\n    rows = 13:19\n  ) |>\n  tab_options(table.font.size = \"small\") |> \n  cols_label(\n    Goals = \"Цель\",\n    Week = \"Неделя\"\n  ) |> \n  tab_options(\n    table.width = px(250)\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gpyyxjiypi\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gpyyxjiypi table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gpyyxjiypi thead, #gpyyxjiypi tbody, #gpyyxjiypi tfoot, #gpyyxjiypi tr, #gpyyxjiypi td, #gpyyxjiypi th {\n  border-style: none;\n}\n\n#gpyyxjiypi p {\n  margin: 0;\n  padding: 0;\n}\n\n#gpyyxjiypi .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: small;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 250px;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gpyyxjiypi .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gpyyxjiypi .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gpyyxjiypi .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gpyyxjiypi .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gpyyxjiypi .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gpyyxjiypi .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gpyyxjiypi .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gpyyxjiypi .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gpyyxjiypi .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gpyyxjiypi .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gpyyxjiypi .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gpyyxjiypi .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gpyyxjiypi .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gpyyxjiypi .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpyyxjiypi .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gpyyxjiypi .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gpyyxjiypi .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gpyyxjiypi .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpyyxjiypi .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gpyyxjiypi .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpyyxjiypi .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gpyyxjiypi .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpyyxjiypi .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gpyyxjiypi .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gpyyxjiypi .gt_left {\n  text-align: left;\n}\n\n#gpyyxjiypi .gt_center {\n  text-align: center;\n}\n\n#gpyyxjiypi .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gpyyxjiypi .gt_font_normal {\n  font-weight: normal;\n}\n\n#gpyyxjiypi .gt_font_bold {\n  font-weight: bold;\n}\n\n#gpyyxjiypi .gt_font_italic {\n  font-style: italic;\n}\n\n#gpyyxjiypi .gt_super {\n  font-size: 65%;\n}\n\n#gpyyxjiypi .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gpyyxjiypi .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gpyyxjiypi .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gpyyxjiypi .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gpyyxjiypi .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gpyyxjiypi .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gpyyxjiypi .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal\" style>Данные по целям</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Источник данных: Директ</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Неделя\">Неделя</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Цель\">Цель</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Восьмая неделя\">Восьмая неделя</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-19</th>\n<td headers=\"Восьмая неделя stub_1_1 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_1 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-20</th>\n<td headers=\"Восьмая неделя stub_1_2 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_2 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-21</th>\n<td headers=\"Восьмая неделя stub_1_3 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_3 Goals\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-22</th>\n<td headers=\"Восьмая неделя stub_1_4 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_4 Goals\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-23</th>\n<td headers=\"Восьмая неделя stub_1_5 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_5 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-24</th>\n<td headers=\"Восьмая неделя stub_1_6 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_6 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><th id=\"stub_1_7\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-25</th>\n<td headers=\"Восьмая неделя stub_1_7 Week\" class=\"gt_row gt_right\">08</td>\n<td headers=\"Восьмая неделя stub_1_7 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Седьмая неделя\">Седьмая неделя</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_8\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-12</th>\n<td headers=\"Седьмая неделя stub_1_8 Week\" class=\"gt_row gt_right\" style=\"color: #FF0000;\">07</td>\n<td headers=\"Седьмая неделя stub_1_8 Goals\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><th id=\"stub_1_9\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-13</th>\n<td headers=\"Седьмая неделя stub_1_9 Week\" class=\"gt_row gt_right\" style=\"color: #FF0000;\">07</td>\n<td headers=\"Седьмая неделя stub_1_9 Goals\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><th id=\"stub_1_10\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-14</th>\n<td headers=\"Седьмая неделя stub_1_10 Week\" class=\"gt_row gt_right\" style=\"color: #FF0000;\">07</td>\n<td headers=\"Седьмая неделя stub_1_10 Goals\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><th id=\"stub_1_11\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-15</th>\n<td headers=\"Седьмая неделя stub_1_11 Week\" class=\"gt_row gt_right\" style=\"color: #FF0000;\">07</td>\n<td headers=\"Седьмая неделя stub_1_11 Goals\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><th id=\"stub_1_12\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-16</th>\n<td headers=\"Седьмая неделя stub_1_12 Week\" class=\"gt_row gt_right\" style=\"color: #FF0000;\">07</td>\n<td headers=\"Седьмая неделя stub_1_12 Goals\" class=\"gt_row gt_right\">1</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"3\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Шестая неделя\">Шестая неделя</th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><th id=\"stub_1_13\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-05</th>\n<td headers=\"Шестая неделя stub_1_13 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_13 Goals\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><th id=\"stub_1_14\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-06</th>\n<td headers=\"Шестая неделя stub_1_14 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_14 Goals\" class=\"gt_row gt_right\">0</td></tr>\n    <tr><th id=\"stub_1_15\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-07</th>\n<td headers=\"Шестая неделя stub_1_15 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_15 Goals\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><th id=\"stub_1_16\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-08</th>\n<td headers=\"Шестая неделя stub_1_16 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_16 Goals\" class=\"gt_row gt_right\">3</td></tr>\n    <tr><th id=\"stub_1_17\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-09</th>\n<td headers=\"Шестая неделя stub_1_17 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_17 Goals\" class=\"gt_row gt_right\">1</td></tr>\n    <tr><th id=\"stub_1_18\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-10</th>\n<td headers=\"Шестая неделя stub_1_18 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_18 Goals\" class=\"gt_row gt_right\">4</td></tr>\n    <tr><th id=\"stub_1_19\" scope=\"row\" class=\"gt_row gt_right gt_stub\">2024-02-11</th>\n<td headers=\"Шестая неделя stub_1_19 Week\" class=\"gt_row gt_right\">06</td>\n<td headers=\"Шестая неделя stub_1_19 Goals\" class=\"gt_row gt_right\">1</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\nКак видно из таблицы, по сравнению с предыдущей и следующей неделями на седьмой неделе распределение целей и их кол-во отличаются. Остается выяснить, в каких кампаниях, группах, объявлениях что послужило причиной таких аномалий, и рассматриваем возможность масштабирования. \n\nКонкретно в нашем случаи были запущены новые тестовые кампании, что повлияло на кол-во целей, но далее РК не запускались.\n\n\n\n\n## Выводы\n\nИтак, мы выяснили, что существует три основных типа контрольные карты:\n\n- $XmR$-карта индивидульных значений и скользящего размаха,\n- $\\bar{X}R$-карта средних значений и размаха,\n- $U$-карты альтернативных значений.\n\nи в зависимости от ситуации применяется подходящая для случая.\n\nПоняли, как узнать мощность нашей рекламной системы по анализируемой KPI и когда нужно реагировать на текущие процессы.\n\nУзнали, что истинные значения KPI нам нужны для улучшения процессов. Вопрос лишь в том, какие усилия нам нужно приложить для получения желаемого результата. Об этом чуть-чуть подробнее.\n\nЗная системные значения KPI, мы можем корректно ставить задачи ответственным за привлечение клиентов в компанию. Разберем пример.\n\nВ первую очередь выясним, что влияет на кол-во обращений в компанию.\n\nФормула получения обращений (лидов) в компанию:\n\n$$Leads = Impressions × CTR × CR$$\n\n$Impressions$ — показы объявлений на площадках системы привлечения трафика. Данный параметр рассчитывается как произведение $GRP×Fq$, т. е. охват (кол-во уникальных браузеров) на кол-во показов объявлений одному пользователю (браузеру). Специалист влияет на данный параметр:\n\n- через таргеты;\n- настройку стратегии показов объявлений;\n- бюджеты. \n\nПри этом бюджет является ключевым, так как сильно влияет на охват. Например, если бюджета не хватает, то объявления будут показываться на последних местах или в самом низу страниц, из-за чего охват по таргету сильно снижается.\n\n$CTR$ — коэффициент конверсии из охваченных браузеров в перешедших на сайт. На этот параметр влияет: кол-во конкурентов в отрасли, тип площадки, формат объявления и его качество. Специалист влияет на данный параметр:\n\n- через формат и качество объявлений;\n- тип площадки (сети или поиск).\n\n$СR$— коэффициент конверсии из перешедших в обратившихся в компанию. На данный параметр сильно влияют: кол-во конкурентов в отрасли, тип услуги или продукта, цена на товар или услугу, наличие товара, качество контента и посадочных страниц и так далее. Специалист влияет на данный параметр:\n\n- через стратегию показов объявлений (с помощью обучения стратегий на макро- или микроконверсиях);\n- тип площадок (и частично на качество площадок в РСЯ);\n- тип устройства, на котором показывают объявление; \n- структуру и контент посадочных страниц.\n\nДопустим, мы хотим прирасти на 15% по кол-ву обращений в каждый месяц. Как нам это сделать? Построим таблицу, где мы воздействуем на параметры: показы, CTR, CR с усилием по 15% на каждый параметр. Произведем расчеты, основываясь на средних значениях за последние три месяца.\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"rpwwnpzucz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rpwwnpzucz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rpwwnpzucz thead, #rpwwnpzucz tbody, #rpwwnpzucz tfoot, #rpwwnpzucz tr, #rpwwnpzucz td, #rpwwnpzucz th {\n  border-style: none;\n}\n\n#rpwwnpzucz p {\n  margin: 0;\n  padding: 0;\n}\n\n#rpwwnpzucz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: 500px;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rpwwnpzucz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rpwwnpzucz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rpwwnpzucz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rpwwnpzucz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rpwwnpzucz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rpwwnpzucz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rpwwnpzucz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rpwwnpzucz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rpwwnpzucz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rpwwnpzucz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rpwwnpzucz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rpwwnpzucz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rpwwnpzucz .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rpwwnpzucz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rpwwnpzucz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rpwwnpzucz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rpwwnpzucz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rpwwnpzucz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rpwwnpzucz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rpwwnpzucz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rpwwnpzucz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rpwwnpzucz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rpwwnpzucz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rpwwnpzucz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rpwwnpzucz .gt_left {\n  text-align: left;\n}\n\n#rpwwnpzucz .gt_center {\n  text-align: center;\n}\n\n#rpwwnpzucz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rpwwnpzucz .gt_font_normal {\n  font-weight: normal;\n}\n\n#rpwwnpzucz .gt_font_bold {\n  font-weight: bold;\n}\n\n#rpwwnpzucz .gt_font_italic {\n  font-style: italic;\n}\n\n#rpwwnpzucz .gt_super {\n  font-size: 65%;\n}\n\n#rpwwnpzucz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rpwwnpzucz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rpwwnpzucz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rpwwnpzucz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rpwwnpzucz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rpwwnpzucz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rpwwnpzucz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_title gt_font_normal\" style>52% ежемесячный прирост по лидам</td>\n    </tr>\n    <tr class=\"gt_heading\">\n      <td colspan=\"5\" class=\"gt_heading gt_subtitle gt_font_normal gt_bottom_border\" style>Дополнительно получим 22 обращения в месяц</td>\n    </tr>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Impressions\">Impressions</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CTR\">CTR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"CR\">CR</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Leads\">Leads</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Среднее</th>\n<td headers=\"stub_1_1 Impressions\" class=\"gt_row gt_right\">17000</td>\n<td headers=\"stub_1_1 CTR\" class=\"gt_row gt_right\">9.6%</td>\n<td headers=\"stub_1_1 CR\" class=\"gt_row gt_right\">2.6%</td>\n<td headers=\"stub_1_1 Leads\" class=\"gt_row gt_right\">42</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Прогноз</th>\n<td headers=\"stub_1_2 Impressions\" class=\"gt_row gt_right\">19550</td>\n<td headers=\"stub_1_2 CTR\" class=\"gt_row gt_right\">11.04%</td>\n<td headers=\"stub_1_2 CR\" class=\"gt_row gt_right\">2.99%</td>\n<td headers=\"stub_1_2 Leads\" class=\"gt_row gt_right\">65</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_left gt_stub\">Дельта</th>\n<td headers=\"stub_1_3 Impressions\" class=\"gt_row gt_right\">2550</td>\n<td headers=\"stub_1_3 CTR\" class=\"gt_row gt_right\">1.44%</td>\n<td headers=\"stub_1_3 CR\" class=\"gt_row gt_right\">0.39%</td>\n<td headers=\"stub_1_3 Leads\" class=\"gt_row gt_right\">22</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\nВ итоге, если мы будем воздействовать на каждый параметр с усилием в $15\\%$, то общий прирост по лидам составит $52\\%$ ($1.15×1.15×1.15$), что составит плюс $22$ конверсии в месяц дополнительно!\n\nОднако нужно понять степень приложения усилия на каждый параметр для прироста. Поэтому дальнейшие размышления должны происходить в ключе: а можем ли мы поднять текущий CR на $0,39\\%$? Не уперлись ли мы в потолок? Поднять CR с $1\\%$ до $2–3\\%$ достаточно просто, но вот поднять с $5\\%$ до $6\\%$ уже намного сложнее и требует больше усилий. Как с достижением скорости света: чем ближе к пределу, тем больше энергии нужно потратить.\n\nНа этом всё! Сиди, думай и действуй.\n\n:::{.callout}\nЕсть проект, в котором я буду полезен. Обращайтесь!\n[Контакты](https://ihourglass.ru/contacts.html)\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}