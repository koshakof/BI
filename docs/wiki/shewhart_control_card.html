<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Коршаков Александр">
<meta name="description" content="Оптимизация рекламных кампаний, SEO трафика и любых других источников с помощью метода шести сигм (контрольных карт Шухарта)">

<title>Применяем ГОСТ стандарт РФ для оптимизация рекламных кампаний – Hourglass</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="..//favicon/favicon_ihourglass.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"light",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"ru"
  });
});
</script> 
  
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KB6J3FZF');</script>
<!-- End Google Tag Manager -->
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Применяем ГОСТ стандарт РФ для оптимизация рекламных кампаний">
<meta property="og:description" content="Методика применения контрольных карт Шухарта">
<meta property="og:site_name" content="Hourglass">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Hourglass</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Поиск"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Переключить навигацию" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> <i class="bi bi-house" role="img">
</i> 
<span class="menu-text"> </span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../services.html"> 
<span class="menu-text">Услуги</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cases.html"> 
<span class="menu-text">Кейсы</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../wiki.html"> 
<span class="menu-text">Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../contacts.html"> 
<span class="menu-text">Контакты</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#на-что-смотрит-специалист-в-метрике" id="toc-на-что-смотрит-специалист-в-метрике" class="nav-link active" data-scroll-target="#на-что-смотрит-специалист-в-метрике">На что смотрит специалист в «Метрике»?</a></li>
  <li><a href="#что-за-ккш" id="toc-что-за-ккш" class="nav-link" data-scroll-target="#что-за-ккш">Что за «ККШ»!?</a></li>
  <li><a href="#какие-задачи-решают-ккш" id="toc-какие-задачи-решают-ккш" class="nav-link" data-scroll-target="#какие-задачи-решают-ккш">Какие задачи решают ККШ?</a></li>
  <li><a href="#как-работать-с-картами" id="toc-как-работать-с-картами" class="nav-link" data-scroll-target="#как-работать-с-картами">Как работать с картами</a></li>
  <li><a href="#типы-контрольных-карт" id="toc-типы-контрольных-карт" class="nav-link" data-scroll-target="#типы-контрольных-карт">Типы контрольных карт</a>
  <ul class="collapse">
  <li><a href="#xmr-карты" id="toc-xmr-карты" class="nav-link" data-scroll-target="#xmr-карты"><span class="math inline">\(XmR\)</span>-карты</a></li>
  <li><a href="#u-карты" id="toc-u-карты" class="nav-link" data-scroll-target="#u-карты"><span class="math inline">\(U\)</span>-карты</a></li>
  <li><a href="#barxr-карты" id="toc-barxr-карты" class="nav-link" data-scroll-target="#barxr-карты"><span class="math inline">\(\bar{X}R\)</span>-карты</a></li>
  </ul></li>
  <li><a href="#выводы" id="toc-выводы" class="nav-link" data-scroll-target="#выводы">Выводы</a></li>
  </ul>
<div class="quarto-other-links"><h2>Другие ссылки</h2><ul><li><a href="https://disk.yandex.ru/d/qjabnXIB_qafig"><i class="bi bi-link-45deg"></i>ГОСТ Р 50779.42-99</a></li><li><a href="https://en.wikipedia.org/wiki/Western_Electric_rules"><i class="bi bi-link-45deg"></i>Western Electric rules</a></li><li><a href="https://en.wikipedia.org/wiki/Nelson_rules"><i class="bi bi-link-45deg"></i>Nelson rules</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Применяем ГОСТ стандарт РФ для оптимизация рекламных кампаний и других источников трафика</h1>
<p class="subtitle lead">Методика применения контрольных карт Шухарта</p>
  <div class="quarto-categories">
    <div class="quarto-category">Реклама</div>
    <div class="quarto-category">Анализ данных</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Автор</div>
    <div class="quarto-title-meta-contents">
             <p>Александр Коршаков </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Дата публикации</div>
    <div class="quarto-title-meta-contents">
      <p class="date">9 апреля 2024 г.</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<!-- Чанки для пред. настроек -->
<div class="cell">
<details class="code-fold">
<summary>Код: библиотеки</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># библиотеки используемые в статье для создания графиков, таблиц и обработки данных.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qcc)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(imputeTS)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<!-- END -->
<section id="на-что-смотрит-специалист-в-метрике" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="на-что-смотрит-специалист-в-метрике">На что смотрит специалист в «Метрике»?</h2>
<p>Запустив рекламные кампании, неизбежно наступает момент анализа эффективности. И вот специалист создает отчет, как на графиках ниже. И что он видит?</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Столбиковый график</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подготовка таблицы</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>acc_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cost =</span> <span class="fu">round</span>(Cost),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">CPA =</span> <span class="fu">if_else</span>(Goals <span class="sc">==</span> <span class="dv">0</span> , <span class="dv">0</span>, <span class="fu">round</span>(Cost <span class="sc">/</span> Goals)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">CPC =</span> <span class="fu">if_else</span>(Cost <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(Cost <span class="sc">/</span> Clicks)),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">CTR =</span> <span class="fu">if_else</span>(Clicks <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(Clicks <span class="sc">/</span> Impressions <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">CR =</span> <span class="fu">if_else</span>(Goals <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(Goals <span class="sc">/</span> Clicks <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">SR =</span> <span class="fu">if_else</span>(Clicks <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(Sessions <span class="sc">/</span> Clicks, <span class="dv">1</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">BR =</span> <span class="fu">if_else</span>(Bounces <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">0</span>, <span class="fu">round</span>(Bounces <span class="sc">/</span> Sessions <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>acc_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  acc_df,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> Date , </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Sessions</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'#ff79c6'</span>) <span class="sc">+</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"2 day"</span>, </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%d.%m"</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Визиты"</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">"Источник: Директ"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Визиты"</span>,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>),</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>), </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">t =</span> <span class="fl">0.3</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">r =</span> <span class="fl">0.3</span>, </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">b =</span> <span class="fl">0.3</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">l =</span> <span class="fl">0.3</span>, </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>        <span class="st">"cm"</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем интерактивный график</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(acc_plot)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d532a45bfcf813d7438b" style="width:100%;height:520px;"></div>
<script type="application/json" data-for="htmlwidget-d532a45bfcf813d7438b">{"x":{"data":[{"orientation":"v","width":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[19731,19732,19733,19734,19735,19736,19737,19738,19739,19740,19741,19742,19743,19744,19745,19746,19747,19748,19749,19750,19751,19752,19753,19754,19755,19756,19757,19758,19759,19760,19761,19762,19763,19764,19765,19766,19767,19768,19769,19770,19771,19772,19773,19774,19775,19776,19777,19778,19779,19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19790,19791,19792,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],"y":[75,148,108,82,31,15,144,184,170,45,16,15,17,148,117,109,22,39,18,3,130,115,106,22,19,20,14,279,543,202,294,263,343,356,167,142,134,132,95,63,13,146,243,187,110,200,169,136,181,99,122,113,133,123,104,138,93,95,97,33,29,34,108,114,100,131,109,93,43,154,136,139,123,110,100,67,147,161,140,122],"text":["Date: 2024-01-09<br />Sessions:  75","Date: 2024-01-10<br />Sessions: 148","Date: 2024-01-11<br />Sessions: 108","Date: 2024-01-12<br />Sessions:  82","Date: 2024-01-13<br />Sessions:  31","Date: 2024-01-14<br />Sessions:  15","Date: 2024-01-15<br />Sessions: 144","Date: 2024-01-16<br />Sessions: 184","Date: 2024-01-17<br />Sessions: 170","Date: 2024-01-18<br />Sessions:  45","Date: 2024-01-19<br />Sessions:  16","Date: 2024-01-20<br />Sessions:  15","Date: 2024-01-21<br />Sessions:  17","Date: 2024-01-22<br />Sessions: 148","Date: 2024-01-23<br />Sessions: 117","Date: 2024-01-24<br />Sessions: 109","Date: 2024-01-25<br />Sessions:  22","Date: 2024-01-26<br />Sessions:  39","Date: 2024-01-27<br />Sessions:  18","Date: 2024-01-28<br />Sessions:   3","Date: 2024-01-29<br />Sessions: 130","Date: 2024-01-30<br />Sessions: 115","Date: 2024-01-31<br />Sessions: 106","Date: 2024-02-01<br />Sessions:  22","Date: 2024-02-02<br />Sessions:  19","Date: 2024-02-03<br />Sessions:  20","Date: 2024-02-04<br />Sessions:  14","Date: 2024-02-05<br />Sessions: 279","Date: 2024-02-06<br />Sessions: 543","Date: 2024-02-07<br />Sessions: 202","Date: 2024-02-08<br />Sessions: 294","Date: 2024-02-09<br />Sessions: 263","Date: 2024-02-10<br />Sessions: 343","Date: 2024-02-11<br />Sessions: 356","Date: 2024-02-12<br />Sessions: 167","Date: 2024-02-13<br />Sessions: 142","Date: 2024-02-14<br />Sessions: 134","Date: 2024-02-15<br />Sessions: 132","Date: 2024-02-16<br />Sessions:  95","Date: 2024-02-17<br />Sessions:  63","Date: 2024-02-18<br />Sessions:  13","Date: 2024-02-19<br />Sessions: 146","Date: 2024-02-20<br />Sessions: 243","Date: 2024-02-21<br />Sessions: 187","Date: 2024-02-22<br />Sessions: 110","Date: 2024-02-23<br />Sessions: 200","Date: 2024-02-24<br />Sessions: 169","Date: 2024-02-25<br />Sessions: 136","Date: 2024-02-26<br />Sessions: 181","Date: 2024-02-27<br />Sessions:  99","Date: 2024-02-28<br />Sessions: 122","Date: 2024-02-29<br />Sessions: 113","Date: 2024-03-01<br />Sessions: 133","Date: 2024-03-02<br />Sessions: 123","Date: 2024-03-03<br />Sessions: 104","Date: 2024-03-04<br />Sessions: 138","Date: 2024-03-05<br />Sessions:  93","Date: 2024-03-06<br />Sessions:  95","Date: 2024-03-07<br />Sessions:  97","Date: 2024-03-08<br />Sessions:  33","Date: 2024-03-09<br />Sessions:  29","Date: 2024-03-10<br />Sessions:  34","Date: 2024-03-11<br />Sessions: 108","Date: 2024-03-12<br />Sessions: 114","Date: 2024-03-13<br />Sessions: 100","Date: 2024-03-14<br />Sessions: 131","Date: 2024-03-15<br />Sessions: 109","Date: 2024-03-16<br />Sessions:  93","Date: 2024-03-17<br />Sessions:  43","Date: 2024-03-18<br />Sessions: 154","Date: 2024-03-19<br />Sessions: 136","Date: 2024-03-20<br />Sessions: 139","Date: 2024-03-21<br />Sessions: 123","Date: 2024-03-22<br />Sessions: 110","Date: 2024-03-23<br />Sessions: 100","Date: 2024-03-24<br />Sessions:  67","Date: 2024-03-25<br />Sessions: 147","Date: 2024-03-26<br />Sessions: 161","Date: 2024-03-27<br />Sessions: 140","Date: 2024-03-28<br />Sessions: 122"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,121,198,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.113452505858938,"r":11.338582677165356,"b":44.393236648656782,"l":44.215295005932475},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Визиты","font":{"color":"rgba(102,102,102,1)","family":"","size":15.940224159402243},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[19726.555,19814.445],"tickmode":"array","ticktext":["06.01","08.01","10.01","12.01","14.01","16.01","18.01","20.01","22.01","24.01","26.01","28.01","30.01","01.02","03.02","05.02","07.02","09.02","11.02","13.02","15.02","17.02","19.02","21.02","23.02","25.02","27.02","29.02","02.03","04.03","06.03","08.03","10.03","12.03","14.03","16.03","18.03","20.03","22.03","24.03","26.03","28.03","30.03","01.04"],"tickvals":[19728,19730,19732,19734,19736,19738,19740,19742,19744,19746,19748,19750,19752,19754,19756,19758,19760,19762,19764,19766,19768,19770,19772,19774,19776,19778,19780,19782,19784,19786,19788,19790,19792,19794,19796,19798,19800,19802,19804,19806,19808,19810,19812,19814],"categoryorder":"array","categoryarray":["06.01","08.01","10.01","12.01","14.01","16.01","18.01","20.01","22.01","24.01","26.01","28.01","30.01","01.02","03.02","05.02","07.02","09.02","11.02","13.02","15.02","17.02","19.02","21.02","23.02","25.02","27.02","29.02","02.03","04.03","06.03","08.03","10.03","12.03","14.03","16.03","18.03","20.03","22.03","24.03","26.03","28.03","30.03","01.04"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-27.150000000000002,570.14999999999998],"tickmode":"array","ticktext":["0","200","400"],"tickvals":[0,200,400],"categoryorder":"array","categoryarray":["0","200","400"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Визиты","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"48e41ee1349b":{"x":{},"y":{},"type":"bar"}},"cur_data":"48e41ee1349b","visdat":{"48e41ee1349b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Или вот такой график.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Линейный график</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подготовка таблицы</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>camp <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date, CampaignId)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span><span class="st">'2024-03-01'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># проверяем на пропущенные дни и заполняем NA</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>camp <span class="ot">&lt;-</span> camp <span class="sc">|&gt;</span> </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(<span class="at">index =</span> Date, <span class="at">key =</span> CampaignId) <span class="sc">|&gt;</span> </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill_gaps</span>()</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>camp_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    camp, </span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Date , </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> Clicks, </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> CampaignId, </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> CampaignId)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Clicks)),</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">check_overlap =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fl">2.5</span>,</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"grey50"</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"1 day"</span>, </span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%d.%m"</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Переходы"</span>,</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Источник: Директ"</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Клики"</span>,</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"ID"</span></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"#f9fbfd"</span>, <span class="at">colour =</span> <span class="st">"white"</span>),</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>),</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>), </span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="fl">0.3</span>,</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> <span class="fl">0.3</span>, </span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.3</span>,</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">l =</span> <span class="fl">0.3</span>, </span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cm"</span></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>camp_plot</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/line clicks plot-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Прекрасные графики показывают нам нежно-розовые столбики и цветные линии в динамике. Но очень быстро приходит вопрос: «И что?». А и вправду! Что нам делать с этой информацией?</p>
<p>Эта динамика хороша или плоха? Мне стоит переживать, что столбик от 15.02 выше, чем от 14.02, или, может, даже от 10.01!? Какие решения я должен принять, изучив этот график?</p>
<p>Тогда, может, таблица в помощь?</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Таблица</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>acc_gt_tbl <span class="ot">&lt;-</span> acc_df <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>(<span class="at">rowname_col =</span> <span class="st">"Date"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Метрики по аккаунту"</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Источник данных: Директ"</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Goals,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> \(v) <span class="fu">lapply</span>(v, \(x) <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="st">"darkred"</span> <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="st">"darkgreen"</span> <span class="cf">else</span> <span class="st">"black"</span>),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">apply_to =</span> <span class="st">"text"</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Cost,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">fn =</span> \(v) <span class="fu">lapply</span>(v, \(x) <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">1000</span>) <span class="st">"darkgreen"</span> <span class="cf">else</span> <span class="cf">if</span> (x <span class="sc">&gt;</span> <span class="dv">1000</span>) <span class="st">"darkred"</span> <span class="cf">else</span> <span class="st">"black"</span>),</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">apply_to =</span> <span class="st">"text"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_currency</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> <span class="fu">c</span>(Cost, CPA, CPC),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">currency =</span> <span class="st">"RUB"</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">decimals =</span> <span class="dv">0</span>,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">placement =</span> <span class="st">"right"</span>,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep_mark =</span> <span class="st">" "</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>acc_gt_tbl</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-body-outset">
<div id="vseytxdlai" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vseytxdlai table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vseytxdlai thead, #vseytxdlai tbody, #vseytxdlai tfoot, #vseytxdlai tr, #vseytxdlai td, #vseytxdlai th {
  border-style: none;
}

#vseytxdlai p {
  margin: 0;
  padding: 0;
}

#vseytxdlai .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vseytxdlai .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vseytxdlai .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vseytxdlai .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vseytxdlai .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vseytxdlai .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vseytxdlai .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vseytxdlai .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vseytxdlai .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vseytxdlai .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vseytxdlai .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vseytxdlai .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vseytxdlai .gt_spanner_row {
  border-bottom-style: hidden;
}

#vseytxdlai .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vseytxdlai .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vseytxdlai .gt_from_md > :first-child {
  margin-top: 0;
}

#vseytxdlai .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vseytxdlai .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vseytxdlai .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vseytxdlai .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vseytxdlai .gt_row_group_first td {
  border-top-width: 2px;
}

#vseytxdlai .gt_row_group_first th {
  border-top-width: 2px;
}

#vseytxdlai .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vseytxdlai .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vseytxdlai .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vseytxdlai .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vseytxdlai .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vseytxdlai .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vseytxdlai .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vseytxdlai .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vseytxdlai .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vseytxdlai .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vseytxdlai .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vseytxdlai .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vseytxdlai .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vseytxdlai .gt_left {
  text-align: left;
}

#vseytxdlai .gt_center {
  text-align: center;
}

#vseytxdlai .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vseytxdlai .gt_font_normal {
  font-weight: normal;
}

#vseytxdlai .gt_font_bold {
  font-weight: bold;
}

#vseytxdlai .gt_font_italic {
  font-style: italic;
}

#vseytxdlai .gt_super {
  font-size: 65%;
}

#vseytxdlai .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vseytxdlai .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vseytxdlai .gt_indent_1 {
  text-indent: 5px;
}

#vseytxdlai .gt_indent_2 {
  text-indent: 10px;
}

#vseytxdlai .gt_indent_3 {
  text-indent: 15px;
}

#vseytxdlai .gt_indent_4 {
  text-indent: 20px;
}

#vseytxdlai .gt_indent_5 {
  text-indent: 25px;
}

#vseytxdlai .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vseytxdlai div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="13" class="gt_heading gt_title gt_font_normal">Метрики по аккаунту</th>
</tr>
<tr class="odd gt_heading">
<th colspan="13" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Источник данных: Директ</th>
</tr>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Cost" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Cost</th>
<th id="Impressions" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Impressions</th>
<th id="Clicks" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Clicks</th>
<th id="Sessions" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sessions</th>
<th id="Bounces" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Bounces</th>
<th id="Goals" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Goals</th>
<th id="CPA" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CPA</th>
<th id="CPC" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CPC</th>
<th id="CTR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CTR</th>
<th id="CR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CR</th>
<th id="SR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">SR</th>
<th id="BR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">BR</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td id="stub_1_1" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-09</td>
<td class="gt_row gt_right" headers="stub_1_1 Cost" style="color: #8B0000">1 320₽</td>
<td class="gt_row gt_right" headers="stub_1_1 Impressions">10689</td>
<td class="gt_row gt_right" headers="stub_1_1 Clicks">69</td>
<td class="gt_row gt_right" headers="stub_1_1 Sessions">75</td>
<td class="gt_row gt_right" headers="stub_1_1 Bounces">24</td>
<td class="gt_row gt_right" headers="stub_1_1 Goals" style="color: #8B0000">0</td>
<td class="gt_row gt_right" headers="stub_1_1 CPA">0₽</td>
<td class="gt_row gt_right" headers="stub_1_1 CPC">19₽</td>
<td class="gt_row gt_right" headers="stub_1_1 CTR">0.6</td>
<td class="gt_row gt_right" headers="stub_1_1 CR">0.0</td>
<td class="gt_row gt_right" headers="stub_1_1 SR">1.1</td>
<td class="gt_row gt_right" headers="stub_1_1 BR">32.0</td>
</tr>
<tr class="even">
<td id="stub_1_2" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-10</td>
<td class="gt_row gt_right" headers="stub_1_2 Cost" style="color: #8B0000">3 490₽</td>
<td class="gt_row gt_right" headers="stub_1_2 Impressions">9714</td>
<td class="gt_row gt_right" headers="stub_1_2 Clicks">154</td>
<td class="gt_row gt_right" headers="stub_1_2 Sessions">148</td>
<td class="gt_row gt_right" headers="stub_1_2 Bounces">40</td>
<td class="gt_row gt_right" headers="stub_1_2 Goals" style="color: #006400">3</td>
<td class="gt_row gt_right" headers="stub_1_2 CPA">1 163₽</td>
<td class="gt_row gt_right" headers="stub_1_2 CPC">23₽</td>
<td class="gt_row gt_right" headers="stub_1_2 CTR">1.6</td>
<td class="gt_row gt_right" headers="stub_1_2 CR">1.9</td>
<td class="gt_row gt_right" headers="stub_1_2 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_2 BR">27.0</td>
</tr>
<tr class="odd">
<td id="stub_1_3" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-11</td>
<td class="gt_row gt_right" headers="stub_1_3 Cost" style="color: #8B0000">3 273₽</td>
<td class="gt_row gt_right" headers="stub_1_3 Impressions">6185</td>
<td class="gt_row gt_right" headers="stub_1_3 Clicks">114</td>
<td class="gt_row gt_right" headers="stub_1_3 Sessions">108</td>
<td class="gt_row gt_right" headers="stub_1_3 Bounces">17</td>
<td class="gt_row gt_right" headers="stub_1_3 Goals" style="color: #006400">3</td>
<td class="gt_row gt_right" headers="stub_1_3 CPA">1 091₽</td>
<td class="gt_row gt_right" headers="stub_1_3 CPC">29₽</td>
<td class="gt_row gt_right" headers="stub_1_3 CTR">1.8</td>
<td class="gt_row gt_right" headers="stub_1_3 CR">2.6</td>
<td class="gt_row gt_right" headers="stub_1_3 SR">0.9</td>
<td class="gt_row gt_right" headers="stub_1_3 BR">15.7</td>
</tr>
<tr class="even">
<td id="stub_1_4" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-12</td>
<td class="gt_row gt_right" headers="stub_1_4 Cost" style="color: #8B0000">2 242₽</td>
<td class="gt_row gt_right" headers="stub_1_4 Impressions">3507</td>
<td class="gt_row gt_right" headers="stub_1_4 Clicks">91</td>
<td class="gt_row gt_right" headers="stub_1_4 Sessions">82</td>
<td class="gt_row gt_right" headers="stub_1_4 Bounces">12</td>
<td class="gt_row gt_right" headers="stub_1_4 Goals" style="color: #000000">1</td>
<td class="gt_row gt_right" headers="stub_1_4 CPA">2 242₽</td>
<td class="gt_row gt_right" headers="stub_1_4 CPC">25₽</td>
<td class="gt_row gt_right" headers="stub_1_4 CTR">2.6</td>
<td class="gt_row gt_right" headers="stub_1_4 CR">1.1</td>
<td class="gt_row gt_right" headers="stub_1_4 SR">0.9</td>
<td class="gt_row gt_right" headers="stub_1_4 BR">14.6</td>
</tr>
<tr class="odd">
<td id="stub_1_5" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-13</td>
<td class="gt_row gt_right" headers="stub_1_5 Cost" style="color: #006400">376₽</td>
<td class="gt_row gt_right" headers="stub_1_5 Impressions">1456</td>
<td class="gt_row gt_right" headers="stub_1_5 Clicks">32</td>
<td class="gt_row gt_right" headers="stub_1_5 Sessions">31</td>
<td class="gt_row gt_right" headers="stub_1_5 Bounces">4</td>
<td class="gt_row gt_right" headers="stub_1_5 Goals" style="color: #000000">1</td>
<td class="gt_row gt_right" headers="stub_1_5 CPA">376₽</td>
<td class="gt_row gt_right" headers="stub_1_5 CPC">12₽</td>
<td class="gt_row gt_right" headers="stub_1_5 CTR">2.2</td>
<td class="gt_row gt_right" headers="stub_1_5 CR">3.1</td>
<td class="gt_row gt_right" headers="stub_1_5 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_5 BR">12.9</td>
</tr>
<tr class="even">
<td id="stub_1_6" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-14</td>
<td class="gt_row gt_right" headers="stub_1_6 Cost" style="color: #006400">169₽</td>
<td class="gt_row gt_right" headers="stub_1_6 Impressions">1079</td>
<td class="gt_row gt_right" headers="stub_1_6 Clicks">18</td>
<td class="gt_row gt_right" headers="stub_1_6 Sessions">15</td>
<td class="gt_row gt_right" headers="stub_1_6 Bounces">3</td>
<td class="gt_row gt_right" headers="stub_1_6 Goals" style="color: #8B0000">0</td>
<td class="gt_row gt_right" headers="stub_1_6 CPA">0₽</td>
<td class="gt_row gt_right" headers="stub_1_6 CPC">9₽</td>
<td class="gt_row gt_right" headers="stub_1_6 CTR">1.7</td>
<td class="gt_row gt_right" headers="stub_1_6 CR">0.0</td>
<td class="gt_row gt_right" headers="stub_1_6 SR">0.8</td>
<td class="gt_row gt_right" headers="stub_1_6 BR">20.0</td>
</tr>
<tr class="odd">
<td id="stub_1_7" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-15</td>
<td class="gt_row gt_right" headers="stub_1_7 Cost" style="color: #8B0000">3 517₽</td>
<td class="gt_row gt_right" headers="stub_1_7 Impressions">4234</td>
<td class="gt_row gt_right" headers="stub_1_7 Clicks">141</td>
<td class="gt_row gt_right" headers="stub_1_7 Sessions">144</td>
<td class="gt_row gt_right" headers="stub_1_7 Bounces">22</td>
<td class="gt_row gt_right" headers="stub_1_7 Goals" style="color: #006400">3</td>
<td class="gt_row gt_right" headers="stub_1_7 CPA">1 172₽</td>
<td class="gt_row gt_right" headers="stub_1_7 CPC">25₽</td>
<td class="gt_row gt_right" headers="stub_1_7 CTR">3.3</td>
<td class="gt_row gt_right" headers="stub_1_7 CR">2.1</td>
<td class="gt_row gt_right" headers="stub_1_7 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_7 BR">15.3</td>
</tr>
<tr class="even">
<td id="stub_1_8" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-16</td>
<td class="gt_row gt_right" headers="stub_1_8 Cost" style="color: #8B0000">3 498₽</td>
<td class="gt_row gt_right" headers="stub_1_8 Impressions">5132</td>
<td class="gt_row gt_right" headers="stub_1_8 Clicks">181</td>
<td class="gt_row gt_right" headers="stub_1_8 Sessions">184</td>
<td class="gt_row gt_right" headers="stub_1_8 Bounces">37</td>
<td class="gt_row gt_right" headers="stub_1_8 Goals" style="color: #006400">3</td>
<td class="gt_row gt_right" headers="stub_1_8 CPA">1 166₽</td>
<td class="gt_row gt_right" headers="stub_1_8 CPC">19₽</td>
<td class="gt_row gt_right" headers="stub_1_8 CTR">3.5</td>
<td class="gt_row gt_right" headers="stub_1_8 CR">1.7</td>
<td class="gt_row gt_right" headers="stub_1_8 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_8 BR">20.1</td>
</tr>
<tr class="odd">
<td id="stub_1_9" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-17</td>
<td class="gt_row gt_right" headers="stub_1_9 Cost" style="color: #8B0000">2 908₽</td>
<td class="gt_row gt_right" headers="stub_1_9 Impressions">3651</td>
<td class="gt_row gt_right" headers="stub_1_9 Clicks">170</td>
<td class="gt_row gt_right" headers="stub_1_9 Sessions">170</td>
<td class="gt_row gt_right" headers="stub_1_9 Bounces">29</td>
<td class="gt_row gt_right" headers="stub_1_9 Goals" style="color: #006400">4</td>
<td class="gt_row gt_right" headers="stub_1_9 CPA">727₽</td>
<td class="gt_row gt_right" headers="stub_1_9 CPC">17₽</td>
<td class="gt_row gt_right" headers="stub_1_9 CTR">4.7</td>
<td class="gt_row gt_right" headers="stub_1_9 CR">2.4</td>
<td class="gt_row gt_right" headers="stub_1_9 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_9 BR">17.1</td>
</tr>
<tr class="even">
<td id="stub_1_10" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-01-18</td>
<td class="gt_row gt_right" headers="stub_1_10 Cost" style="color: #006400">528₽</td>
<td class="gt_row gt_right" headers="stub_1_10 Impressions">4113</td>
<td class="gt_row gt_right" headers="stub_1_10 Clicks">43</td>
<td class="gt_row gt_right" headers="stub_1_10 Sessions">45</td>
<td class="gt_row gt_right" headers="stub_1_10 Bounces">9</td>
<td class="gt_row gt_right" headers="stub_1_10 Goals" style="color: #8B0000">0</td>
<td class="gt_row gt_right" headers="stub_1_10 CPA">0₽</td>
<td class="gt_row gt_right" headers="stub_1_10 CPC">12₽</td>
<td class="gt_row gt_right" headers="stub_1_10 CTR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_10 CR">0.0</td>
<td class="gt_row gt_right" headers="stub_1_10 SR">1.0</td>
<td class="gt_row gt_right" headers="stub_1_10 BR">20.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><br></p>
<p>Эффективна наша система по привлечению трафика?</p>
<p>Но у нас же есть KPI! Да, наверняка у нас есть KPI и даже план, сверстанный в красивую презентацию. Но будем честны. При запуске кампаний наши KPI берутся из каких-то примерных показателей в нише. Я бы даже сказал, очень примерных. Это, безусловно, лучше, чем ничего, но, как правило, итоговые KPI отличаются значительно.</p>
<p>Чтобы понять границы истинных KPI, насколько эффективно работают кампании и когда нужно принимать решения, применим силу контрольных карт Шухарта.</p>
<blockquote class="blockquote">
<p>Вопрос к размышлению: а, собственно, зачем вообще знать KPI? Какой в этом смысл?</p>
</blockquote>
</section>
<section id="что-за-ккш" class="level2">
<h2 class="anchored" data-anchor-id="что-за-ккш">Что за «ККШ»!?</h2>
<p>Контрольные карты Шухарта (метод шести сигм) — статистический метод, который позволяет усовершенствовать процессы в компании. В основе метода лежит предположение, что любые динамически меняющиеся во времени показатели могут быть разделены на 2 группы: системные и частные.</p>
<p>Предполагается, что если значение показателя трактуется как неудовлетворительное, то необходимо определиться с корректными методами его исправления, принимая во внимание тот факт, что системные проблемы должны корректироваться системными методами, а частные — частными.</p>
<p>Кроме того, метод используется для оценки повышения / снижения качества управления, предлагая конкретные индикативные показатели, отражающие нарастающую или снижающуюся вариативность процесса (вариативность в концепции рассматривается как главный «враг» эффективности).</p>
<p>Главная задача — научиться различать состояния, в которых находится система, а затем решать, что и кому надо с ней делать (или не делать). ККШ — это и есть диагностический инструмент для ответа на вопрос: надо или не надо вмешиваться в систему, и если надо, то кому?</p>
<p>Контрольные карты Шухарта приняты и введены в действие <a href="https://docs.cntd.ru/document/1200025672">Постановлением Госстандарта России от 15 апреля 1999 г. N 127</a></p>
</section>
<section id="какие-задачи-решают-ккш" class="level2">
<h2 class="anchored" data-anchor-id="какие-задачи-решают-ккш">Какие задачи решают ККШ?</h2>
<p>Контрольные карты применяются в сферах производства и услуг. В нашем случае, мы будем использовать карты для улучшения показателей в рекламных кампаниях.</p>
<p>Глобально, ККШ могут быть применены для улучшения любых показателей в бизнесе, которые зависят от временного ряда. Анализируются различные источники трафика с группировкой данных до нужного уровня, например, типа устройства, кампаний, объявлений, таргетинга или с группировкой по конкретной посадочной странице на сайте.</p>
<p>Таким образом, специалист по трафику применяет карты:</p>
<ul>
<li>для оптимизации рекламных кампаний. Вносим изменения и отслеживаем результат.</li>
<li>Контроль подрядчиков. Появится понимание, ведутся ли работы по оптимизации и насколько эффективен процесс.</li>
<li>Аудит рекламных систем.</li>
<li>АВ-тесты кампаний, рекламных систем, посадочных страниц, объявлений, таргетов и так далее. При этом не нужно выделять отдельные бюджеты и разделять трафик на два потока. Вносим изменения и отслеживаем результат. Карты будут фиксировать изменения анализируемой метрики.</li>
</ul>
<p>Ниже я покажу примеры трех основных типов контрольных карт. Расскажу условия применения и какие выводы можно сделать на основании полученных данных.</p>
</section>
<section id="как-работать-с-картами" class="level2">
<h2 class="anchored" data-anchor-id="как-работать-с-картами">Как работать с картами</h2>
<p>Возможно четыре состояния, в которых находится любой производственный процесс.</p>
<ul>
<li>Идеальное состояние – процесс управляем, и 100% продукции соответствует допускам. - Пороговое состояние – процесс управляем, но не 100% продукции соответствует допускам.</li>
<li>На грани хаоса – процесс неуправляем, хотя вся выпускаемая продукция соответствует допускам.</li>
<li>Состояние хаоса – процесс неуправляем, и периодически производится брак.</li>
</ul>
<p>Энтропия постоянно воздействует на все процессы, вызывая ухудшение качества, разрушение, износ и разрывы, аварии и отказы. Т. е. если не управлять системами привлечения трафика, они в любом случае затухнут, просто потому, что так работают законы Вселенной ;)</p>
<p><strong>Критерии роста системы</strong></p>
<p>Шухарт и Деминг выделили два критерия, которые должны указывать на то, что кампания активно растет:</p>
<ul>
<li>среднеарифметическая растет или снижается в зависимости от параметра;</li>
<li>границы сигмы становятся все более узкими. Сокращая вариативность параметра, мы берем управление под контроль.</li>
</ul>
<p><strong>Критерии ухудшения системы</strong></p>
<ul>
<li>средняя арифметическая снижается или растет, если речь идет о негативном параметре;</li>
<li>на протяжении шести и более дней (контрольных интервалов) значения скачут с нарастающей волатильностью;</li>
<li>если несколько дней подряд наблюдается выход за пределы контрольных границ;</li>
<li>если шесть и более дней наблюдается негативная тенденция в значениях (неважно, сверху или снизу). Т. е. значения находятся над или под средней линией.</li>
</ul>
<p>Ещё правила для обнаружения «вышедших из-под контроля» или неслучайных условий:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Western_Electric_rules">Western Electric rules</a></li>
<li><a href="https://en.wikipedia.org/wiki/Nelson_rules">Nelson rules</a></li>
</ul>
<p><br></p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Есть проект, в котором я буду полезен. Обращайтесь! <a href="https://ihourglass.ru/contacts.html">Контакты</a></p>
</div>
</div>
</div>
</section>
<section id="типы-контрольных-карт" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="типы-контрольных-карт">Типы контрольных карт</h2>
<p>Рассмотрим три основных типа ККШ и способы их создания.</p>
<section id="xmr-карты" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="xmr-карты"><span class="math inline">\(XmR\)</span>-карты</h3>
<p><span class="math inline">\(XmR\)</span>-карты — карты индивидуальных значений и размахов. Данный тип карт применяется, когда нет возможности сгруппировать данные. Эти карты менее точны, чем карты средних значений (<span class="math inline">\(\bar{X}R\)</span>-карты), однако они полезны при старте рекламных кампаний или при планируемых значительных изменениях, которые могут повлиять на границы системы.</p>
<p>Как видно из названия, карт применяются два их типа:</p>
<ul>
<li><p><strong>карта индивидуальных значений</strong> (<span class="math inline">\(X\)</span>-карта). Строится карта в декартовой системе координат, где по оси абсцисс расположены даты, а на оси ординат — значения исследуемой метрики.</p></li>
<li><p><strong>карта размахов</strong> (<span class="math inline">\(mR\)</span>-карта). Размах — это разность между наибольшим и наименьшим значениями. Размах практически не отражает «срединных» значений, поэтому он неэффективен для описания больших массивов данных и используется для описания множеств, число элементов которых не превосходит 15.</p></li>
</ul>
<p>Рассмотрим пример <span class="math inline">\(mR\)</span>-карты расходов по всему аккаунту за 15 дней.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: mR-карта</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подготовка таблицы</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>acc_date <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> Date</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Cost =</span> <span class="fu">round</span>(Cost))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># набор данных для mR-карты</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>mr_cost <span class="ot">&lt;-</span> acc_date <span class="sc">|&gt;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="st">'2024-03-13'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lead =</span> <span class="fu">lead</span>(Cost)) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Cost, Lead) <span class="sc">|&gt;</span> </span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lead)) <span class="sc">|&gt;</span> </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем значения для оси абсцисс</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> acc_date <span class="sc">|&gt;</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span> <span class="st">'2024-03-13'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lab =</span> clock<span class="sc">::</span><span class="fu">date_format</span>(Date, <span class="at">format =</span> <span class="st">"%d.%m"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lab)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>df_lab <span class="ot">&lt;-</span> temp[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(temp) <span class="sc">-</span> <span class="dv">1</span>), ] <span class="sc">|&gt;</span> </span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для mR-карты</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>mr_cost_plot <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"R"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mr_cost,</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> df_lab,</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># создаём mR-картy </span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  mr_cost_plot,</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>,</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"mR-карта расходов по аккаунту"</span>,</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Расходы"</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/mr-card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>На графике видим, что 17.03 наблюдается перерасход средств по аккаунту. Были внесены какие-то действия, которые привели к выходу за границы системных значений. Действительно, в этот день были выставлены новые недельные расходы.</p>
<p>Рассмотрим <span class="math inline">\(X\)</span>-карту индивидуальных значений за весь анализируемый период.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: X-карта</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для х-карты</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>x_cost <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"xbar.one"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> acc_date<span class="sc">$</span>Cost[<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>],</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> acc_date<span class="sc">$</span>Cost[<span class="dv">28</span><span class="sc">:</span><span class="fu">nrow</span>(acc_date)], </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> acc_date<span class="sc">$</span>Date[<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>] <span class="sc">|&gt;</span> <span class="fu">format</span>(<span class="st">"%d.%m"</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">newlabels =</span> acc_date<span class="sc">$</span>Date[<span class="dv">28</span><span class="sc">:</span><span class="fu">nrow</span>(acc_date)] <span class="sc">|&gt;</span> <span class="fu">format</span>(<span class="st">"%d.%m"</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># проверяем нижнюю границу</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>x_cost<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">if_else</span>(x_cost<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, x_cost<span class="sc">$</span>limits[<span class="dv">1</span>])</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  x_cost, </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>, </span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Х-карта </span><span class="sc">\n</span><span class="st"> Период 1: с 09.01. Период 2: с 12.02"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Расход"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> T</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/xbar.one card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>В первую очередь обратим внимание на границы. Нижний порог контрольной границы (<span class="math inline">\(LCL\)</span>) равен <span class="math inline">\(0\)</span>, а верхний — <span class="math inline">\(≈4337\)</span>. На самом деле, нижний порог имеет значение <span class="math inline">\(-1093\)</span>. Но мы не можем потратить минус тысячу рублей, поэтому значение нижней границы приравниваем к нулю.</p>
<p>Стоит отметить, что из-за большего временного периода границы на графике стали шире по сравнению с <span class="math inline">\(mR\)</span>-картой, но для обзора данных нас это устраивает.</p>
<p>На графике красными точками зафиксированы выходы за верхние границы расходов. 05.02 был проведен тестовый запуск на новый регион, что и зафиксировали алгоритмы. Далее с помощью карт анализируются метрики по достижению целей, переходов, расходов, <span class="math inline">\(CTR\)</span>, <span class="math inline">\(CR\)</span> и другие в различных срезах. Например, на графике ниже видны данные по расходам в разрезе двух объявлений выбранной группы.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Столбчатый график</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>ads_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), sum),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date, CampaignId, AdGroupId, AdId)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CampaignId <span class="sc">%in%</span> <span class="st">"107880029"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>         AdGroupId <span class="sc">%in%</span> <span class="st">"5409189158"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># график: столбчатый график с накоплением</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>ads_df_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    ads_df, </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> Date , </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> Cost, </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">group =</span> AdId, </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> AdId</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_date</span>(</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_breaks =</span> <span class="st">"1 day"</span>, </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_labels =</span> <span class="st">"%d.%m"</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Расходы"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Директ"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Расходы, ₽"</span>,</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="cn">NULL</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="fl">0.2</span>,</span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> <span class="fl">0.2</span>, </span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.2</span>,</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">l =</span> <span class="fl">0.2</span>, </span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cm"</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем интерактивный график</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(ads_df_plot,<span class="at">tooltip =</span> <span class="fu">c</span>(<span class="st">"x"</span>,<span class="st">"y"</span>,<span class="st">"group"</span>))</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div class="plotly html-widget html-fill-item" id="htmlwidget-fe6008bdff7f2f5c51e8" style="width:100%;height:520px;"></div>
<script type="application/json" data-for="htmlwidget-fe6008bdff7f2f5c51e8">{"x":{"data":[{"orientation":"v","width":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],"base":[0,208.57999999999998,0,0,0,0,52.310000000000002,92.459999999999994,26.25,12.619999999999999,472.89999999999998,373.94,478.44,186.75999999999999,323.85000000000002,115.44,48.07,149.56999999999999,570.91999999999996,433.59999999999997,94.200000000000003,108.17,74.019999999999996,114.44,187.56,194.94,150.06999999999999,18.460000000000001],"x":[19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],"y":[148.81,641.88000000000011,212.21000000000001,274.07999999999998,303.58999999999997,0,407.54000000000002,705.80000000000007,438.39999999999998,239.22000000000003,353.82000000000005,402.98999999999995,229.26000000000005,89.350000000000023,83.009999999999991,14.370000000000005,9.9200000000000017,223.96999999999997,88.529999999999973,144.17000000000002,132.18000000000001,98.739999999999995,174.44999999999999,51.5,401.59000000000009,503.72000000000008,210.46999999999997,273.79000000000002],"text":["Date: 2024-02-27<br />Cost: 148.81<br />AdId: 15883344950","Date: 2024-02-28<br />Cost: 641.88<br />AdId: 15883344950","Date: 2024-02-29<br />Cost: 212.21<br />AdId: 15883344950","Date: 2024-03-01<br />Cost: 274.08<br />AdId: 15883344950","Date: 2024-03-02<br />Cost: 303.59<br />AdId: 15883344950","Date: 2024-03-03<br />Cost:   0.00<br />AdId: 15883344950","Date: 2024-03-04<br />Cost: 407.54<br />AdId: 15883344950","Date: 2024-03-05<br />Cost: 705.80<br />AdId: 15883344950","Date: 2024-03-06<br />Cost: 438.40<br />AdId: 15883344950","Date: 2024-03-07<br />Cost: 239.22<br />AdId: 15883344950","Date: 2024-03-11<br />Cost: 353.82<br />AdId: 15883344950","Date: 2024-03-12<br />Cost: 402.99<br />AdId: 15883344950","Date: 2024-03-13<br />Cost: 229.26<br />AdId: 15883344950","Date: 2024-03-14<br />Cost:  89.35<br />AdId: 15883344950","Date: 2024-03-15<br />Cost:  83.01<br />AdId: 15883344950","Date: 2024-03-16<br />Cost:  14.37<br />AdId: 15883344950","Date: 2024-03-17<br />Cost:   9.92<br />AdId: 15883344950","Date: 2024-03-18<br />Cost: 223.97<br />AdId: 15883344950","Date: 2024-03-19<br />Cost:  88.53<br />AdId: 15883344950","Date: 2024-03-20<br />Cost: 144.17<br />AdId: 15883344950","Date: 2024-03-21<br />Cost: 132.18<br />AdId: 15883344950","Date: 2024-03-22<br />Cost:  98.74<br />AdId: 15883344950","Date: 2024-03-23<br />Cost: 174.45<br />AdId: 15883344950","Date: 2024-03-24<br />Cost:  51.50<br />AdId: 15883344950","Date: 2024-03-25<br />Cost: 401.59<br />AdId: 15883344950","Date: 2024-03-26<br />Cost: 503.72<br />AdId: 15883344950","Date: 2024-03-27<br />Cost: 210.47<br />AdId: 15883344950","Date: 2024-03-28<br />Cost: 273.79<br />AdId: 15883344950"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"15883344950","legendgroup":"15883344950","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"orientation":"v","width":[0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519,0.90000000000145519],"base":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"x":[19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810],"y":[0,208.57999999999998,0,0,0,0,52.310000000000002,92.459999999999994,26.25,12.619999999999999,472.89999999999998,373.94,478.44,186.75999999999999,323.85000000000002,115.44,48.07,149.56999999999999,570.91999999999996,433.59999999999997,94.200000000000003,108.17,74.019999999999996,114.44,187.56,194.94,150.06999999999999,18.460000000000001],"text":["Date: 2024-02-27<br />Cost:   0.00<br />AdId: 15883344951","Date: 2024-02-28<br />Cost: 208.58<br />AdId: 15883344951","Date: 2024-02-29<br />Cost:   0.00<br />AdId: 15883344951","Date: 2024-03-01<br />Cost:   0.00<br />AdId: 15883344951","Date: 2024-03-02<br />Cost:   0.00<br />AdId: 15883344951","Date: 2024-03-03<br />Cost:   0.00<br />AdId: 15883344951","Date: 2024-03-04<br />Cost:  52.31<br />AdId: 15883344951","Date: 2024-03-05<br />Cost:  92.46<br />AdId: 15883344951","Date: 2024-03-06<br />Cost:  26.25<br />AdId: 15883344951","Date: 2024-03-07<br />Cost:  12.62<br />AdId: 15883344951","Date: 2024-03-11<br />Cost: 472.90<br />AdId: 15883344951","Date: 2024-03-12<br />Cost: 373.94<br />AdId: 15883344951","Date: 2024-03-13<br />Cost: 478.44<br />AdId: 15883344951","Date: 2024-03-14<br />Cost: 186.76<br />AdId: 15883344951","Date: 2024-03-15<br />Cost: 323.85<br />AdId: 15883344951","Date: 2024-03-16<br />Cost: 115.44<br />AdId: 15883344951","Date: 2024-03-17<br />Cost:  48.07<br />AdId: 15883344951","Date: 2024-03-18<br />Cost: 149.57<br />AdId: 15883344951","Date: 2024-03-19<br />Cost: 570.92<br />AdId: 15883344951","Date: 2024-03-20<br />Cost: 433.60<br />AdId: 15883344951","Date: 2024-03-21<br />Cost:  94.20<br />AdId: 15883344951","Date: 2024-03-22<br />Cost: 108.17<br />AdId: 15883344951","Date: 2024-03-23<br />Cost:  74.02<br />AdId: 15883344951","Date: 2024-03-24<br />Cost: 114.44<br />AdId: 15883344951","Date: 2024-03-25<br />Cost: 187.56<br />AdId: 15883344951","Date: 2024-03-26<br />Cost: 194.94<br />AdId: 15883344951","Date: 2024-03-27<br />Cost: 150.07<br />AdId: 15883344951","Date: 2024-03-28<br />Cost:  18.46<br />AdId: 15883344951"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"name":"15883344951","legendgroup":"15883344951","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":41.389043057040034,"r":7.559055118110237,"b":39.668827199837878,"l":40.435767446877357},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Расходы","font":{"color":"rgba(102,102,102,1)","family":"","size":15.940224159402243},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[19778.004999999997,19811.995000000003],"tickmode":"array","ticktext":["26.02","27.02","28.02","29.02","01.03","02.03","03.03","04.03","05.03","06.03","07.03","08.03","09.03","10.03","11.03","12.03","13.03","14.03","15.03","16.03","17.03","18.03","19.03","20.03","21.03","22.03","23.03","24.03","25.03","26.03","27.03","28.03","29.03"],"tickvals":[19779,19780,19781,19782,19783,19784,19785,19786,19787,19788,19789,19790,19791,19792,19793,19794,19795,19796,19797,19798,19799,19800,19801,19802,19803,19804,19805,19806,19807,19808,19809,19810,19811],"categoryorder":"array","categoryarray":["26.02","27.02","28.02","29.02","01.03","02.03","03.03","04.03","05.03","06.03","07.03","08.03","09.03","10.03","11.03","12.03","13.03","14.03","15.03","16.03","17.03","18.03","19.03","20.03","21.03","22.03","23.03","24.03","25.03","26.03","27.03","28.03","29.03"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-42.523000000000003,892.98300000000006],"tickmode":"array","ticktext":["0","200","400","600","800"],"tickvals":[0,200.00000000000003,400,600,800],"categoryorder":"array","categoryarray":["0","200","400","600","800"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Расходы, ₽","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"title":{"text":"","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"48e443a032d1":{"x":{},"y":{},"fill":{},"type":"bar"}},"cur_data":"48e443a032d1","visdat":{"48e443a032d1":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
<p>Рассмотрим <span class="math inline">\(R\)</span>-карту размахов по кликам «красного» объявления.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: R-карта</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># набор данных для mR-карты</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mr_df <span class="ot">&lt;-</span> ads_df <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdId <span class="sc">%in%</span> <span class="st">'15883344950'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lead =</span> <span class="fu">lead</span>(Clicks)) <span class="sc">|&gt;</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Clicks, Lead) <span class="sc">|&gt;</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Lead)) <span class="sc">|&gt;</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем значения для оси абсцисс</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> ads_df <span class="sc">|&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdId <span class="sc">%in%</span> <span class="st">'15883344950'</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lab =</span> clock<span class="sc">::</span><span class="fu">date_format</span>(Date, <span class="at">format =</span> <span class="st">"%d.%m"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(lab)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>lab_df <span class="ot">&lt;-</span> temp[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">nrow</span>(temp) <span class="sc">-</span> <span class="dv">1</span>), ] <span class="sc">|&gt;</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для mR-карты</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>mr_plot <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"R"</span>,</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mr_df,</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> lab_df,</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="co"># создаём mR-картy </span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>  mr_plot,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"mR-карта"</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Клики"</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/ad r-card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Обнаружены два выхода за контрольные границы. Фиксируем разницу в кликах между 27 и 28 датами в феврале и между 24 и 25 в марте. Знаем из графика выше, что в эти дни был меньший расход на объявления по сравнению со следующим днём.</p>
<p>Создадим <span class="math inline">\(X\)</span>-карту.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: X-карта</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ads_qcc <span class="ot">&lt;-</span> ads_df <span class="sc">|&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdId <span class="sc">%in%</span> <span class="st">'15883344950'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для х-карты</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>x_df <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"xbar.one"</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ads_qcc<span class="sc">$</span>Clicks,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> ads_qcc<span class="sc">$</span>Date <span class="sc">|&gt;</span> <span class="fu">format</span>(<span class="st">"%d.%m"</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># устанавливаем предупреждающие границы</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sg1 <span class="ot">&lt;-</span> <span class="fu">limits.xbar.one</span>(x_df<span class="sc">$</span>center, x_df<span class="sc">$</span>std.dev, x_df<span class="sc">$</span>sizes, <span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>sg2 <span class="ot">&lt;-</span> <span class="fu">limits.xbar.one</span>(x_df<span class="sc">$</span>center, x_df<span class="sc">$</span>std.dev, x_df<span class="sc">$</span>sizes, <span class="dv">2</span>)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># корректировка нижней границы LCL</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>x_df<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">if_else</span>(x_df<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, x_df<span class="sc">$</span>limits[<span class="dv">1</span>])</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  x_df, </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Х-карта"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Клики"</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># добавляем предупреждающие границы</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> sg1, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> sg2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/ad x-card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Видим, что на графике индивидуальных значений нет выхода за границы. Это означает, что система фиксирует на карте размахов дни, когда алгоритмы показа объявлений начинают корректировку показов объявлений, но на общую картину это не влияет, и количество кликов не выходит за границы, т. е. тут видна работа системы, а не работа специалиста.</p>
<p><br></p>
</section>
<section id="u-карты" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="u-карты"><span class="math inline">\(U\)</span>-карты</h3>
<p>Ниже текст из ГОСТ.</p>
<p><em>«Данный тип карт используется для анализа альтернативных данных. Альтернативные данные представляют собой наблюдения, фиксирующие наличие или отсутствие некоторых характеристик (или признаков) у каждой единицы рассматриваемой подгруппы. На основе этих данных производится подсчет числа единиц, обладающих или не обладающих данным признаком, или число таких событий в единице продукции, группе или области. … U-карты основаны на распределении Пуассона.»</em></p>
<blockquote class="blockquote">
<p>Кстати, вы знаете, как рассчитать бюджет для рекламной кампании с помощью распределения Пуассона? Об этом, пожалуй, напишу в следующей статье.</p>
</blockquote>
<p>Данные карты используются для выявления брака на единицу продукции или на выборку из продукции. В нашем случае в роли выборки выступает метрика показов или кликов сгруппированная по дням, месяцам или иным подгруппам, а кол-во «брака» в нашем случаи это кол-во кликов или достигнутых целей. На картах отображаются отношения кликов к показам (CTR) или целей к кликам (CR) в абсолютных единицах.</p>
<p>Анализировать «ситиар» по всему аккаунту дело не благодарное и исключительно тревожное. Данная метрика сильно зависит от типов рекламных кампаний используемых в аккаунте.</p>
<p>Например, в аккаунте может быть одна РК на поиске, а вторая в РСЯ, тогда средний «ситиар» нам в целом ни о чем не скажет. Потому что «ситиар» на поиске сильно выше чем в РСЯ.</p>
<p>Более того, если РК в РСЯ переодически отключается, то мы будем создавать эффект «низкой базы» из-за чего наш график будет «болеть» корью (множество красных точек — сигнал выходы за границы «разумного»).</p>
<p>Пример данных по аккаунту.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: U-карта</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подготовка таблицы</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ctr_u <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Impressions, Clicks), sum),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> Date</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для u-карты</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>ctr_u_plot <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"u"</span>,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ctr_u[[<span class="dv">3</span>]],</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes =</span> ctr_u[[<span class="dv">2</span>]],</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> ctr_u<span class="sc">$</span>Date <span class="sc">|&gt;</span> <span class="fu">format</span>(<span class="st">"%d.%m"</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  ctr_u_plot,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"U-карта коэф. кликов (CTR) </span><span class="sc">\n</span><span class="st"> в абсолютных значениях"</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"CTR"</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/account u-card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>График «заболел». Анализировать такие данные не имеет смысла. Необходимо разделить данные по типу рекламных кампаний.</p>
<p>Рассмотрим <span class="math inline">\(u\)</span>-карту CTR на примере поискового трафика.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: U-карта</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># подготовка таблицы</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>u_card <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Impressions, Clicks), sum),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date, AdNetworkType)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># фильтруем данные</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>ctr_u <span class="ot">&lt;-</span> u_card <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdNetworkType <span class="sc">%in%</span> <span class="st">'SEARCH'</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>         Date<span class="sc">&gt;=</span><span class="st">"2024-03-01"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, Impressions, Clicks)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для u-карты</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>ctr_u_plot <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"u"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> ctr_u[[<span class="dv">3</span>]],</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizes =</span> ctr_u[[<span class="dv">2</span>]],</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> ctr_u<span class="sc">$</span>Date <span class="sc">|&gt;</span> <span class="fu">format</span>(<span class="st">"%d.%m"</span>),</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  ctr_u_plot,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes.las =</span> <span class="dv">2</span>, </span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"U-карта коэф. кликов (CTR) </span><span class="sc">\n</span><span class="st"> в абсолютных значениях"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"CTR"</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/search u-card-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Особенность данной карты в том, что у неё плавающие границы. Как именно они рассчитываются, описано в ГОСТе.</p>
<p>Карта хорошо помогает в работе с объявлениями. Вносим изменение в объявление и наблюдаем, как сильно это повлияло на заметность объявления в поиске или в рекламных сетях Яндекса.</p>
<p>Также данный тип карты можно применять при работе над повышением конверсии на посадочных страницах.</p>
</section>
<section id="barxr-карты" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="barxr-карты"><span class="math inline">\(\bar{X}R\)</span>-карты</h3>
<p>Ниже текст из ГОСТ.</p>
<blockquote class="blockquote">
<p><em>«Карты запускаются вместе с процессом и дают независимую картину того, на что процесс способен. После этого характеристики процесса можно сравнивать или нет с установленными требованиями.</em></p>
<p><em>Карты для количественных данных отражают состояние процесса через разброс (изменчивость от единицы к единице) и через расположение центра (среднее процесса). Поэтому контрольные карты для количественных данных почти всегда применяют и анализируют парами — одна карта для расположения и одна — для разброса.»</em></p>
</blockquote>
<p>Ключевое:</p>
<ul>
<li><p>карты дают независимую картину того, на что процесс способен. Т. е. мы точно знаем мощность источника трафика и сможем установить контрольные KPI.</p></li>
<li><p>контрольные карты используются парами. Одна карта — расположение средних значений в декартовой системе координат, и одна для разброса.</p></li>
</ul>
<p>Приведу пример анализа целей по всему аккаунту.</p>
<p>Сначала рассмотрим данные по достижению целей на столбчатом графике для лучшего понимания происходящего на контрольных картах.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Столбчатый график</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>goal_df <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdNetworkType <span class="sc">%in%</span> <span class="st">'SEARCH'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Week =</span> clock<span class="sc">::</span><span class="fu">date_format</span>(Date, <span class="at">format =</span> <span class="st">"%W"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Goals), sum),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Week)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>goal_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  goal_df,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> Week , </span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> Goals</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">'#ff79c6'</span>) <span class="sc">+</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Цели на поиске сгруппированные по неделям"</span>,</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Источник: Директ"</span>,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Неделя"</span>,</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Кол-во целей"</span>,</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Номер недели"</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray40"</span>),</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"top"</span>,</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.justification =</span> <span class="st">"left"</span>,</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box.spacing =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>),</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"gray50"</span>),</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.margin =</span> ggplot2<span class="sc">::</span><span class="fu">margin</span>(</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">t =</span> <span class="fl">0.3</span>,</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">r =</span> <span class="fl">0.3</span>, </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">b =</span> <span class="fl">0.3</span>,</span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">l =</span> <span class="fl">0.3</span>, </span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">"cm"</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a><span class="co"># создаем интерактивный график</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(goal_plot)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-body-outset">
<div class="plotly html-widget html-fill-item" id="htmlwidget-e6c9657253f1cb074f04" style="width:100%;height:520px;"></div>
<script type="application/json" data-for="htmlwidget-e6c9657253f1cb074f04">{"x":{"data":[{"orientation":"v","width":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.89999999999999947,0.89999999999999858,0.89999999999999858,0.89999999999999858,0.89999999999999858],"base":[0,0,0,0,0,0,0,0,0,0,0,0],"x":[1,2,3,4,5,6,7,8,9,10,11,12],"y":[7,9,2,6,11,15,6,5,5,6,8,11],"text":["Week: 02<br />Goals:  7","Week: 03<br />Goals:  9","Week: 04<br />Goals:  2","Week: 05<br />Goals:  6","Week: 06<br />Goals: 11","Week: 07<br />Goals: 15","Week: 08<br />Goals:  6","Week: 09<br />Goals:  5","Week: 10<br />Goals:  5","Week: 11<br />Goals:  6","Week: 12<br />Goals:  8","Week: 13<br />Goals: 11"],"type":"bar","textposition":"none","marker":{"autocolorscale":false,"color":"rgba(255,121,198,1)","line":{"width":1.8897637795275593,"color":"transparent"}},"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":46.113452505858938,"r":11.338582677165356,"b":41.736532622089747,"l":38.901886952798399},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"title":{"text":"Цели на поиске сгруппированные по неделям","font":{"color":"rgba(102,102,102,1)","family":"","size":15.940224159402243},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.40000000000000002,12.6],"tickmode":"array","ticktext":["02","03","04","05","06","07","08","09","10","11","12","13"],"tickvals":[1,2,3,4.0000000000000009,5,6,7.0000000000000009,8,9,10,11,12],"categoryorder":"array","categoryarray":["02","03","04","05","06","07","08","09","10","11","12","13"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-90,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"Неделя","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.75,15.75],"tickmode":"array","ticktext":["0","5","10","15"],"tickvals":[0,5,10,15],"categoryorder":"array","categoryarray":["0","5","10","15"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.6529680365296811,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"Кол-во целей","font":{"color":"rgba(127,127,127,1)","family":"","size":13.283520132835205}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(127,127,127,1)","family":"","size":10.62681610626816}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"48e437403726":{"x":{},"y":{},"type":"bar"}},"cur_data":"48e437403726","visdat":{"48e437403726":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br></p>
<p>Создаем карту <em>размахов средних значений</em> по неделям.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: R-карта</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># создадим набор данных и дополним пропущенные дни значением по алгоритму Калмана </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>xr_card <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Goals), sum),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date, AdNetworkType)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdNetworkType <span class="sc">%in%</span> <span class="st">'SEARCH'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tsibble</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> Date, </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> AdNetworkType</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill_gaps</span>(</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">.start =</span> <span class="fu">as.Date</span>(<span class="st">'2024-01-08'</span>), </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">.end =</span> <span class="fu">as.Date</span>(<span class="st">'2024-03-31'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  imputeTS<span class="sc">::</span><span class="fu">na_kalman</span>() <span class="sc">|&gt;</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">Goals =</span> <span class="fu">round</span>(Goals),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">Week =</span> clock<span class="sc">::</span><span class="fu">date_format</span>(Date, <span class="at">format =</span> <span class="st">"%W"</span>)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># группируем данные для графика</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>xr_card_gr <span class="ot">&lt;-</span> <span class="fu">with</span>(xr_card, <span class="fu">qcc.groups</span>(Goals , Week))</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для создания графика</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>xr_card_plt <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"R"</span>,</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> xr_card_gr[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,],</span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> xr_card_gr[<span class="dv">4</span><span class="sc">:</span><span class="fu">nrow</span>(xr_card_gr),],</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co"># установка предупредждающих границ</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>sg1 <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(xr_card_plt<span class="sc">$</span>center, xr_card_plt<span class="sc">$</span>std.dev, xr_card_plt<span class="sc">$</span>sizes, <span class="dv">1</span>)</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>sg2 <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(xr_card_plt<span class="sc">$</span>center, xr_card_plt<span class="sc">$</span>std.dev, xr_card_plt<span class="sc">$</span>sizes, <span class="dv">2</span>)</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="co"># корректировка нижней границы LCL</span></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">if_else</span>(xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>])</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-41"><a href="#cb13-41" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb13-42"><a href="#cb13-42" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb13-43"><a href="#cb13-43" aria-hidden="true" tabindex="-1"></a>  xr_card_plt,</span>
<span id="cb13-44"><a href="#cb13-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Процесс находится под стат контролем </span><span class="sc">\n</span><span class="st"> Выходы за границы не обнаружены"</span>,</span>
<span id="cb13-45"><a href="#cb13-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Цель"</span>,</span>
<span id="cb13-46"><a href="#cb13-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Неделя"</span>,</span>
<span id="cb13-47"><a href="#cb13-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span></span>
<span id="cb13-48"><a href="#cb13-48" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/avr.r plot-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Что видно на графике?</p>
<p>ГОСТ</p>
<blockquote class="blockquote">
<p><em><span class="math inline">\(R\)</span>-карта выявляет любую нежелательную вариацию внутри подгрупп и служит индикатором изменчивости исследуемого процесса. Это мера состоятельности и однородности процесса. Если <span class="math inline">\(R\)</span>-карта показывает, что вариации внутри подгрупп не изменяются, то это значит, что процесс остается в статистически управляемом состоянии.</em></p>
</blockquote>
<p>В данном случае трафик из Директа находится в статистически управляемом процессе. Выходы за границы не обнаружены. Т. е. внутри подгрупп (неделя) вариации по достижению целей остаются под контролем.</p>
<p>Создаем карту <em>средних значений</em>, сгруппированных по неделям.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: X-карта</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># данные для создания графика</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>xr_card_plt <span class="ot">&lt;-</span> <span class="fu">qcc</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"xbar"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> xr_card_gr[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,],</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">newdata =</span> xr_card_gr[<span class="dv">4</span><span class="sc">:</span><span class="fu">nrow</span>(xr_card_gr),],</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> <span class="cn">FALSE</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># установка предупредждающих границ</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>sg1 <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(xr_card_plt<span class="sc">$</span>center, xr_card_plt<span class="sc">$</span>std.dev, xr_card_plt<span class="sc">$</span>sizes, <span class="dv">1</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>sg2 <span class="ot">&lt;-</span> <span class="fu">limits.xbar</span>(xr_card_plt<span class="sc">$</span>center, xr_card_plt<span class="sc">$</span>std.dev, xr_card_plt<span class="sc">$</span>sizes, <span class="dv">2</span>)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># корректировка нижней границы LCL</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">if_else</span>(xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">0</span>, xr_card_plt<span class="sc">$</span>limits[<span class="dv">1</span>])</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># строим график</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.qcc</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  xr_card_plt,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Обнаружен выход за границы на 7 неделе работы РК"</span>,</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">"Неделя"</span>,</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">"Среднее в неделе"</span>,</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">restore.par =</span> <span class="cn">FALSE</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="co"># добавляем предупреждающие границы</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> sg1, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> sg2, <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">"gray"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="page-columns page-full">
<figure class="figure page-columns page-full">
<p class="page-columns page-full"><img src="shewhart_control_card_files/figure-html/avr.x plot-1.png" class="img-fluid figure-img column-body-outset" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Что мы видим на графике?</p>
<p>Из ГОСТа.</p>
<blockquote class="blockquote">
<p><em><span class="math inline">\(X\)</span>-карта показывает, где находится среднее процесса и какова его стабильность. Та же карта выявляет нежелательные вариации между подгруппами и вариации относительно их среднего.</em></p>
</blockquote>
<p>Интерпретация может быть не совсем очевидной.</p>
<p>Во-первых, на шкале ординат мы видим не суммарные значения по неделям, а среднее значение достигнутых целей внутри недели (по-другому, среднее значение в день). Т. е. мы сложили за неделю все цели и разделили на <span class="math inline">\(7\)</span>. Если сгруппировать данные по месяцам, то получим среднее значение в неделю и так далее. По шкале абсцисс — номер недели 2024 года.</p>
<p>Во-вторых, границы нашей системы по привлечению обращений в кампанию составляют от <span class="math inline">\(0\)</span> до <span class="math inline">\(2–3\)</span> обращений в день. При этом стоит отметить, что в данном случае, если более шести дней подряд кол-во конверсий не меняется (нет обращений или по <span class="math inline">\(1–2\)</span> в день), то переживать, срочно бежать и что-то делать не надо.</p>
<blockquote class="blockquote">
<p>На рынке есть множество ниш со сложными продуктами, где может быть маленький спрос или сложный продукт. В таких нишах, если до шести дней не будет обращений в компанию, то это нормальное явление. Нужно понимать границы системы и в какой нише работаете и корректировать ожидания от рекламных активностей. Плюс не забываем о моделях атрибуции в рекламных системах. Например, я часто сталкиваюсь с тем, что конверсии досчитываются в промежутки до 21 дня.</p>
</blockquote>
<p>Разберемся, что показывает график. На седьмой неделе работы рекламной кампании зафиксирован выход за границу по среднему значению между группами. Исходя из столбчатого графика выше, в этот день было больше всего конверсий за весь анализируемый период, что привело к повышенному среднему значению среди всех остальных групп. Рассмотрим табличные данные в этот период.</p>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Код: Таблица</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>goal_tbl <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AdNetworkType <span class="sc">%in%</span> <span class="st">'SEARCH'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Week =</span> clock<span class="sc">::</span><span class="fu">date_format</span>(Date, <span class="at">format =</span> <span class="st">"%W"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">reframe</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(<span class="fu">c</span>(Goals), sum),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> <span class="fu">c</span>(Date, Week)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Date <span class="sc">&gt;=</span><span class="st">"2024-02-05"</span> <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> <span class="st">"2024-02-25"</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">gt</span>(goal_tbl, <span class="at">rowname_col =</span> <span class="st">"Date"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Данные по целям"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">"Источник данных: Директ"</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data_color</span>(</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">columns =</span> Week,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> Week <span class="sc">==</span> <span class="st">"07"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"auto"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"red"</span>,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">apply_to =</span> <span class="st">"text"</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Шестая неделя"</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Седьмая неделя"</span>,</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">8</span><span class="sc">:</span><span class="dv">12</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_row_group</span>(</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Восьмая неделя"</span>,</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">rows =</span> <span class="dv">13</span><span class="sc">:</span><span class="dv">19</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="st">"small"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">Goals =</span> <span class="st">"Цель"</span>,</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">Week =</span> <span class="st">"Неделя"</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.width =</span> <span class="fu">px</span>(<span class="dv">250</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display column-page">
<div id="prigjfstrl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#prigjfstrl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#prigjfstrl thead, #prigjfstrl tbody, #prigjfstrl tfoot, #prigjfstrl tr, #prigjfstrl td, #prigjfstrl th {
  border-style: none;
}

#prigjfstrl p {
  margin: 0;
  padding: 0;
}

#prigjfstrl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 250px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#prigjfstrl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#prigjfstrl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#prigjfstrl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#prigjfstrl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prigjfstrl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prigjfstrl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#prigjfstrl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#prigjfstrl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#prigjfstrl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#prigjfstrl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#prigjfstrl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#prigjfstrl .gt_spanner_row {
  border-bottom-style: hidden;
}

#prigjfstrl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#prigjfstrl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#prigjfstrl .gt_from_md > :first-child {
  margin-top: 0;
}

#prigjfstrl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#prigjfstrl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#prigjfstrl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#prigjfstrl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#prigjfstrl .gt_row_group_first td {
  border-top-width: 2px;
}

#prigjfstrl .gt_row_group_first th {
  border-top-width: 2px;
}

#prigjfstrl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prigjfstrl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#prigjfstrl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#prigjfstrl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prigjfstrl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#prigjfstrl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#prigjfstrl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#prigjfstrl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#prigjfstrl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#prigjfstrl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prigjfstrl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prigjfstrl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#prigjfstrl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#prigjfstrl .gt_left {
  text-align: left;
}

#prigjfstrl .gt_center {
  text-align: center;
}

#prigjfstrl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#prigjfstrl .gt_font_normal {
  font-weight: normal;
}

#prigjfstrl .gt_font_bold {
  font-weight: bold;
}

#prigjfstrl .gt_font_italic {
  font-style: italic;
}

#prigjfstrl .gt_super {
  font-size: 65%;
}

#prigjfstrl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#prigjfstrl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#prigjfstrl .gt_indent_1 {
  text-indent: 5px;
}

#prigjfstrl .gt_indent_2 {
  text-indent: 10px;
}

#prigjfstrl .gt_indent_3 {
  text-indent: 15px;
}

#prigjfstrl .gt_indent_4 {
  text-indent: 20px;
}

#prigjfstrl .gt_indent_5 {
  text-indent: 25px;
}

#prigjfstrl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#prigjfstrl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="3" class="gt_heading gt_title gt_font_normal">Данные по целям</th>
</tr>
<tr class="odd gt_heading">
<th colspan="3" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Источник данных: Директ</th>
</tr>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Неделя" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Неделя</th>
<th id="Цель" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Цель</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd gt_group_heading_row">
<td colspan="3" id="Восьмая неделя" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Восьмая неделя</td>
</tr>
<tr class="even gt_row_group_first">
<td id="stub_1_1" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-19</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_1 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_1 Goals">0</td>
</tr>
<tr class="odd">
<td id="stub_1_2" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-20</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_2 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_2 Goals">0</td>
</tr>
<tr class="even">
<td id="stub_1_3" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-21</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_3 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_3 Goals">3</td>
</tr>
<tr class="odd">
<td id="stub_1_4" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-22</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_4 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_4 Goals">3</td>
</tr>
<tr class="even">
<td id="stub_1_5" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-23</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_5 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_5 Goals">0</td>
</tr>
<tr class="odd">
<td id="stub_1_6" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-24</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_6 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_6 Goals">0</td>
</tr>
<tr class="even">
<td id="stub_1_7" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-25</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_7 Week">08</td>
<td class="gt_row gt_right" headers="Восьмая неделя stub_1_7 Goals">0</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="3" id="Седьмая неделя" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Седьмая неделя</td>
</tr>
<tr class="even gt_row_group_first">
<td id="stub_1_8" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-12</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_8 Week" style="color: #FF0000">07</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_8 Goals">3</td>
</tr>
<tr class="odd">
<td id="stub_1_9" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-13</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_9 Week" style="color: #FF0000">07</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_9 Goals">3</td>
</tr>
<tr class="even">
<td id="stub_1_10" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-14</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_10 Week" style="color: #FF0000">07</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_10 Goals">4</td>
</tr>
<tr class="odd">
<td id="stub_1_11" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-15</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_11 Week" style="color: #FF0000">07</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_11 Goals">4</td>
</tr>
<tr class="even">
<td id="stub_1_12" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-16</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_12 Week" style="color: #FF0000">07</td>
<td class="gt_row gt_right" headers="Седьмая неделя stub_1_12 Goals">1</td>
</tr>
<tr class="odd gt_group_heading_row">
<td colspan="3" id="Шестая неделя" class="gt_group_heading" data-quarto-table-cell-role="th" scope="colgroup">Шестая неделя</td>
</tr>
<tr class="even gt_row_group_first">
<td id="stub_1_13" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-05</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_13 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_13 Goals">1</td>
</tr>
<tr class="odd">
<td id="stub_1_14" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_14 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_14 Goals">0</td>
</tr>
<tr class="even">
<td id="stub_1_15" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-07</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_15 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_15 Goals">1</td>
</tr>
<tr class="odd">
<td id="stub_1_16" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-08</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_16 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_16 Goals">3</td>
</tr>
<tr class="even">
<td id="stub_1_17" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-09</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_17 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_17 Goals">1</td>
</tr>
<tr class="odd">
<td id="stub_1_18" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-10</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_18 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_18 Goals">4</td>
</tr>
<tr class="even">
<td id="stub_1_19" class="gt_row gt_right gt_stub" data-quarto-table-cell-role="th" scope="row">2024-02-11</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_19 Week">06</td>
<td class="gt_row gt_right" headers="Шестая неделя stub_1_19 Goals">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Как видно из таблицы, по сравнению с предыдущей и следующей неделями на седьмой неделе распределение целей и их кол-во отличаются. Остается выяснить, в каких кампаниях, группах, объявлениях что послужило причиной таких аномалий, и рассматриваем возможность масштабирования.</p>
<p>Конкретно в нашем случаи были запущены новые тестовые кампании, что повлияло на кол-во целей, но далее РК не запускались.</p>
</section>
</section>
<section id="выводы" class="level2">
<h2 class="anchored" data-anchor-id="выводы">Выводы</h2>
<p>Итак, мы выяснили, что существует три основных типа контрольные карты:</p>
<ul>
<li><span class="math inline">\(XmR\)</span>-карта индивидульных значений и скользящего размаха,</li>
<li><span class="math inline">\(\bar{X}R\)</span>-карта средних значений и размаха,</li>
<li><span class="math inline">\(U\)</span>-карты альтернативных значений.</li>
</ul>
<p>и в зависимости от ситуации применяется подходящая для случая.</p>
<p>Поняли, как узнать мощность нашей рекламной системы по анализируемой KPI и когда нужно реагировать на текущие процессы.</p>
<p>Узнали, что истинные значения KPI нам нужны для улучшения процессов. Вопрос лишь в том, какие усилия нам нужно приложить для получения желаемого результата. Об этом чуть-чуть подробнее.</p>
<p>Зная системные значения KPI, мы можем корректно ставить задачи ответственным за привлечение клиентов в компанию. Разберем пример.</p>
<p>В первую очередь выясним, что влияет на кол-во обращений в компанию.</p>
<p>Формула получения обращений (лидов) в компанию:</p>
<p><span class="math display">\[Leads = Impressions × CTR × CR\]</span></p>
<p><span class="math inline">\(Impressions\)</span> — показы объявлений на площадках системы привлечения трафика. Данный параметр рассчитывается как произведение <span class="math inline">\(GRP×Fq\)</span>, т. е. охват (кол-во уникальных браузеров) на кол-во показов объявлений одному пользователю (браузеру). Специалист влияет на данный параметр:</p>
<ul>
<li>через таргеты;</li>
<li>настройку стратегии показов объявлений;</li>
<li>бюджеты.</li>
</ul>
<p>При этом бюджет является ключевым, так как сильно влияет на охват. Например, если бюджета не хватает, то объявления будут показываться на последних местах или в самом низу страниц, из-за чего охват по таргету сильно снижается.</p>
<p><span class="math inline">\(CTR\)</span> — коэффициент конверсии из охваченных браузеров в перешедших на сайт. На этот параметр влияет: кол-во конкурентов в отрасли, тип площадки, формат объявления и его качество. Специалист влияет на данный параметр:</p>
<ul>
<li>через формат и качество объявлений;</li>
<li>тип площадки (сети или поиск).</li>
</ul>
<p><span class="math inline">\(СR\)</span>— коэффициент конверсии из перешедших в обратившихся в компанию. На данный параметр сильно влияют: кол-во конкурентов в отрасли, тип услуги или продукта, цена на товар или услугу, наличие товара, качество контента и посадочных страниц и так далее. Специалист влияет на данный параметр:</p>
<ul>
<li>через стратегию показов объявлений (с помощью обучения стратегий на макро- или микроконверсиях);</li>
<li>тип площадок (и частично на качество площадок в РСЯ);</li>
<li>тип устройства, на котором показывают объявление;</li>
<li>структуру и контент посадочных страниц.</li>
</ul>
<p>Допустим, мы хотим прирасти на 15% по кол-ву обращений в каждый месяц. Как нам это сделать? Построим таблицу, где мы воздействуем на параметры: показы, CTR, CR с усилием по 15% на каждый параметр. Произведем расчеты, основываясь на средних значениях за последние три месяца.</p>
<div class="cell">
<div class="cell-output-display">
<div id="hpezgzsznn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hpezgzsznn table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hpezgzsznn thead, #hpezgzsznn tbody, #hpezgzsznn tfoot, #hpezgzsznn tr, #hpezgzsznn td, #hpezgzsznn th {
  border-style: none;
}

#hpezgzsznn p {
  margin: 0;
  padding: 0;
}

#hpezgzsznn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 500px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hpezgzsznn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hpezgzsznn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hpezgzsznn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hpezgzsznn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hpezgzsznn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpezgzsznn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hpezgzsznn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hpezgzsznn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hpezgzsznn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hpezgzsznn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hpezgzsznn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hpezgzsznn .gt_spanner_row {
  border-bottom-style: hidden;
}

#hpezgzsznn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hpezgzsznn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hpezgzsznn .gt_from_md > :first-child {
  margin-top: 0;
}

#hpezgzsznn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hpezgzsznn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hpezgzsznn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hpezgzsznn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hpezgzsznn .gt_row_group_first td {
  border-top-width: 2px;
}

#hpezgzsznn .gt_row_group_first th {
  border-top-width: 2px;
}

#hpezgzsznn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpezgzsznn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hpezgzsznn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hpezgzsznn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpezgzsznn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpezgzsznn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hpezgzsznn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hpezgzsznn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hpezgzsznn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hpezgzsznn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hpezgzsznn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpezgzsznn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hpezgzsznn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hpezgzsznn .gt_left {
  text-align: left;
}

#hpezgzsznn .gt_center {
  text-align: center;
}

#hpezgzsznn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hpezgzsznn .gt_font_normal {
  font-weight: normal;
}

#hpezgzsznn .gt_font_bold {
  font-weight: bold;
}

#hpezgzsznn .gt_font_italic {
  font-style: italic;
}

#hpezgzsznn .gt_super {
  font-size: 65%;
}

#hpezgzsznn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hpezgzsznn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hpezgzsznn .gt_indent_1 {
  text-indent: 5px;
}

#hpezgzsznn .gt_indent_2 {
  text-indent: 10px;
}

#hpezgzsznn .gt_indent_3 {
  text-indent: 15px;
}

#hpezgzsznn .gt_indent_4 {
  text-indent: 20px;
}

#hpezgzsznn .gt_indent_5 {
  text-indent: 25px;
}

#hpezgzsznn .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#hpezgzsznn div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_heading">
<th colspan="5" class="gt_heading gt_title gt_font_normal">52% ежемесячный прирост по лидам</th>
</tr>
<tr class="odd gt_heading">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Дополнительно получим 22 обращения в месяц</th>
</tr>
<tr class="header gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"></th>
<th id="Impressions" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Impressions</th>
<th id="CTR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CTR</th>
<th id="CR" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">CR</th>
<th id="Leads" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Leads</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td id="stub_1_1" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">Среднее</td>
<td class="gt_row gt_right" headers="stub_1_1 Impressions">17000</td>
<td class="gt_row gt_right" headers="stub_1_1 CTR">9.6%</td>
<td class="gt_row gt_right" headers="stub_1_1 CR">2.6%</td>
<td class="gt_row gt_right" headers="stub_1_1 Leads">42</td>
</tr>
<tr class="even">
<td id="stub_1_2" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">Прогноз</td>
<td class="gt_row gt_right" headers="stub_1_2 Impressions">19550</td>
<td class="gt_row gt_right" headers="stub_1_2 CTR">11.04%</td>
<td class="gt_row gt_right" headers="stub_1_2 CR">2.99%</td>
<td class="gt_row gt_right" headers="stub_1_2 Leads">65</td>
</tr>
<tr class="odd">
<td id="stub_1_3" class="gt_row gt_left gt_stub" data-quarto-table-cell-role="th" scope="row">Дельта</td>
<td class="gt_row gt_right" headers="stub_1_3 Impressions">2550</td>
<td class="gt_row gt_right" headers="stub_1_3 CTR">1.44%</td>
<td class="gt_row gt_right" headers="stub_1_3 CR">0.39%</td>
<td class="gt_row gt_right" headers="stub_1_3 Leads">22</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>В итоге, если мы будем воздействовать на каждый параметр с усилием в <span class="math inline">\(15\%\)</span>, то общий прирост по лидам составит <span class="math inline">\(52\%\)</span> (<span class="math inline">\(1.15×1.15×1.15\)</span>), что составит плюс <span class="math inline">\(22\)</span> конверсии в месяц дополнительно!</p>
<p>Однако нужно понять степень приложения усилия на каждый параметр для прироста. Поэтому дальнейшие размышления должны происходить в ключе: а можем ли мы поднять текущий CR на <span class="math inline">\(0,39\%\)</span>? Не уперлись ли мы в потолок? Поднять CR с <span class="math inline">\(1\%\)</span> до <span class="math inline">\(2–3\%\)</span> достаточно просто, но вот поднять с <span class="math inline">\(5\%\)</span> до <span class="math inline">\(6\%\)</span> уже намного сложнее и требует больше усилий. Как с достижением скорости света: чем ближе к пределу, тем больше энергии нужно потратить.</p>
<p>На этом всё! Сиди, думай и действуй.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Есть проект, в котором я буду полезен. Обращайтесь! <a href="https://ihourglass.ru/contacts.html">Контакты</a></p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KB6J3FZF" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright © ihourglass.ru | Начиная с 2024 г. все права защищены.</p>
</div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
<p>Сайт создан с помощью <a href="https://www.r-project.org/about.html" target="_blank"><i class="fa-brands fa-r-project" title="R Project" aria-label="r-project"></i></a> and <a href="https://quarto.org/" target="_blank">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>